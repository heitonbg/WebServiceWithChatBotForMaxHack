import logging
import os
import random
import datetime
import sys
import re
from typing import List, Optional, Tuple
from sqlalchemy import func

sys.path.append(os.path.dirname(__file__))

from models import SessionLocal, User, Task, Analytics, Project, BoardColumn, BoardCard

QUOTES = [
    "–í—Å–µ, —á—Ç–æ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ä–∞–∑—É–º —Å–ø–æ—Å–æ–±–µ–Ω –ø–æ–Ω—è—Ç—å –∏ –≤–æ —á—Ç–æ –æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω –ø–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç–∏–∂–∏–º–æ. ‚Äî –ù–∞–ø–æ–ª–µ–æ–Ω –•–∏–ª–ª.",
    "–°–ª–æ–∂–Ω–µ–µ –≤—Å–µ–≥–æ –Ω–∞—á–∞—Ç—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç —É–ø–æ—Ä—Å—Ç–≤–∞. ‚Äî –ê–º–µ–ª–∏—è –≠—Ä—Ö–∞—Ä—Ç.",
    "–ù–∞—á–∏–Ω–∞—Ç—å –≤—Å–µ–≥–¥–∞ —Å—Ç–æ–∏—Ç —Å —Ç–æ–≥–æ, —á—Ç–æ —Å–µ–µ—Ç —Å–æ–º–Ω–µ–Ω–∏—è. ‚Äî –ë–æ—Ä–∏—Å –°—Ç—Ä—É–≥–∞—Ü–∫–∏–π.",
    "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —Å–∞–º–∏ ‚Äî –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ –∏—Ö. ‚Äî –ö—Ä–∏—Å –ì—Ä–æ—Å—Å–µ—Ä.",
    "–ù–µ—É–¥–∞—á–∞ ‚Äî —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ, –Ω–æ —É–∂–µ –±–æ–ª–µ–µ –º—É–¥—Ä–æ. ‚Äî –ì–µ–Ω—Ä–∏ –§–æ—Ä–¥.",
    "–í—Å–µ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–æ–ª–Ω—Ü–µ ‚Äî –∏ —Ç–µ–Ω–∏ –±—É–¥—É—Ç –ø–æ–∑–∞–¥–∏ –≤–∞—Å. ‚Äî –£–æ–ª—Ç –£–∏—Ç–º–µ–Ω.",
    "–ï—Å–ª–∏ —è –ø–æ–ª–æ–Ω —Ä–µ—à–∏–º–æ—Å—Ç–∏, —è –ø—Ä–µ–æ–¥–æ–ª–µ—é –ª—é–±–æ–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ. ‚Äî –ê–±–∞–π –ö—É–Ω–∞–Ω–±–∞–µ–≤.",
    "–û–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ —á–∞—Å—Ç–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å, –∏–∑–º–µ–Ω–∏–≤ —Å–≤–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –Ω–∏–º. ‚Äî –≠–ª–µ–æ–Ω–æ—Ä–∞ –†—É–∑–≤–µ–ª—å—Ç.",
    "–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã. ‚Äî –ì–∞–±—Ä–∏—ç–ª—å –ì–∞—Ä—Å–∏–∞ –ú–∞—Ä–∫–µ—Å.",
    "–¢—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞ –Ω–µ —Å–æ–∑–¥–∞—é—Ç –≥–µ—Ä–æ–µ–≤. –ò–º–µ–Ω–Ω–æ –≤ —Ç—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–µ—Ä–æ–π –≤–Ω—É—Ç—Ä–∏ –Ω–∞—Å. ‚Äî –†–æ–±–µ—Ä—Ç –†–µ–Ω—Ñ—Ä–æ –†–∞–π–ª–∏.",
    "–í—Å–µ, —á—Ç–æ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç –≤ –¥—Ä—É–≥–∏—Ö, –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Å–µ–±—è. ‚Äî –ö–∞—Ä–ª –ì—É—Å—Ç–∞–≤ –Æ–Ω–≥.",
    "–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –Ω–µ —Å—Ç–æ–∏—Ç –æ –Ω–µ–π –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è. ‚Äî –î–∞–ª–∞–π-–ª–∞–º–∞ XIV.",
    "–°—á–∞—Å—Ç—å–µ ‚Äî —ç—Ç–æ –Ω–µ –Ω–µ—á—Ç–æ –≥–æ—Ç–æ–≤–æ–µ. –°—á–∞—Å—Ç—å–µ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –≤–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. ‚Äî –î–∞–ª–∞–π-–ª–∞–º–∞ XIV.",
    "–°–∏–ª–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. –ï–µ –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî –Ω–µ—É–∫—Ä–æ—Ç–∏–º–∞—è –≤–æ–ª—è. ‚Äî –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏.",
    "–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π ‚Äî —ç—Ç–æ –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—é –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ –≤ –≤–∏–¥–∏–º–æ–µ. ‚Äî –¢–æ–Ω–∏ –†–æ–±–±–∏–Ω—Å.",
    "–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –≤–æ–æ–±—â–µ —Å—Ç–æ–∏—Ç –ø—Ä–æ–±–æ–≤–∞—Ç—å, —ç—Ç–æ —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ 10 —Ä–∞–∑. ‚Äî –ê—Ä—Ç—É—Ä –ì–æ—Ä–¥–æ–Ω –õ–∏–Ω–∫–ª–µ—Ç—Ç–µ—Ä.",
    "–ï—Å–ª–∏ –≤–∞–º –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –¥–æ—Ä–æ–≥–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –≤—ã –∏–¥–µ—Ç–µ, –Ω–∞—á–Ω–∏—Ç–µ –ø—Ä–æ–∫–ª–∞–¥—ã–≤–∞—Ç—å –¥—Ä—É–≥—É—é. ‚Äî –î–æ–ª–ª–∏ –ü–∞—Ä—Ç–æ–Ω.",
    "–î–æ–π–¥—è –¥–æ –∫–æ–Ω—Ü–∞, –ª—é–¥–∏ —Å–º–µ—é—Ç—Å—è –Ω–∞–¥ —Å—Ç—Ä–∞—Ö–∞–º–∏, –º—É—á–∏–≤—à–∏–º–∏ –∏—Ö –≤–Ω–∞—á–∞–ª–µ. ‚Äî –ü–∞—É–ª–æ –ö–æ—ç–ª—å–æ.",
    "–Ø —Ç–≤–µ—Ä–¥–æ –≤–µ—Ä—é –≤ —É–¥–∞—á—É. –ò —è –∑–∞–º–µ—Ç–∏–ª: —á–µ–º –±–æ–ª—å—à–µ —è —Ä–∞–±–æ—Ç–∞—é, —Ç–µ–º –±–æ–ª—å—à–µ –æ–Ω–∞ –º–Ω–µ —É–ª—ã–±–∞–µ—Ç—Å—è. ‚Äî –¢–æ–º–∞—Å –î–∂–µ—Ñ—Ñ–µ—Ä—Å–æ–Ω.",
    "–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–∞—à–µ –±—É–¥—É—â–µ–µ ‚Äî —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ. ‚Äî –ê–≤—Ä–∞–∞–º –õ–∏–Ω–∫–æ–ª—å–Ω.",
    "–ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–æ, —á—Ç–æ –ª—é–±–∏—Ç–µ, –∏–Ω–∞—á–µ –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ–ª—é–±–∏—Ç—å —Ç–æ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏. ‚Äî –î–∂–æ—Ä–¥–∂ –ë–µ—Ä–Ω–∞—Ä–¥ –®–æ—É.",
    "–ù–µ —Ä–∞—Å—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å —Å–æ —Å–≤–æ–∏–º–∏ –∏–ª–ª—é–∑–∏—è–º–∏. –ö–æ–≥–¥–∞ –∏—Ö –Ω–µ —Å—Ç–∞–Ω–µ—Ç, –º–æ–∂–µ—Ç –±—ã—Ç—å, –≤—ã –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å, –Ω–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç–µ –∂–∏—Ç—å. ‚Äî –ú–∞—Ä–∫ –¢–≤–µ–Ω.",
    "–ï—Å–ª–∏ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, –∫—É–¥–∞ –∏–¥–µ—Ç–µ, –ª—é–±–∞—è –¥–æ—Ä–æ–≥–∞ –ø—Ä–∏–≤–µ–¥–µ—Ç –≤–∞—Å —Ç—É–¥–∞. ‚Äî –î–∂–æ—Ä–¥–∂ –•–∞—Ä—Ä–∏—Å–æ–Ω.",
    "–¢–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ —Ä–∏—Å–∫—É—é—Ç –∑–∞–π—Ç–∏ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ, —Å–ø–æ—Å–æ–±–Ω—ã –≤—ã—è—Å–Ω–∏—Ç—å, –∫–∞–∫ –¥–∞–ª–µ–∫–æ –æ–Ω–∏ –º–æ–≥—É—Ç –∑–∞–π—Ç–∏. ‚Äî –¢–æ–º–∞—Å –°—Ç–µ—Ä–Ω–∑ –≠–ª–∏–æ—Ç.",
    "–ú–æ—Ç–∏–≤–∞—Ü–∏—è ‚Äî —ç—Ç–æ –æ–≥–æ–Ω—å –∏–∑–Ω—É—Ç—Ä–∏. –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–∂–µ—á—å —ç—Ç–æ—Ç –æ–≥–æ–Ω—å –ø–æ–¥ –≤–∞–º–∏, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –æ–Ω –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ —Å–≥–æ—Ä–∏—Ç. ‚Äî –°—Ç–∏–≤–µ–Ω –ö–æ–≤–∏.",
    "–ñ–∏–≤–∏—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–≤–æ–∏–º –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, –∞ –Ω–µ —Å–≤–æ–∏–º –ø—Ä–æ—à–ª—ã–º. ‚Äî –°—Ç–∏–≤–µ–Ω –ö–æ–≤–∏.",
    "–ú–µ—á—Ç–∞–π—Ç–µ –ø–æ-–∫—Ä—É–ø–Ω–æ–º—É –∏ –æ—Å–º–µ–ª—å—Ç–µ—Å—å –ø–æ—Ç–µ—Ä–ø–µ—Ç—å –Ω–µ—É–¥–∞—á—É. ‚Äî –ù–æ—Ä–º–∞–Ω –í–æ–≥–∞–Ω.",
    "–î–∞–π—Ç–µ —á–µ–ª–æ–≤–µ–∫—É —Ü–µ–ª—å, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–π —Å—Ç–æ–∏—Ç –∂–∏—Ç—å, –∏ –æ–Ω —Å–º–æ–∂–µ—Ç –≤—ã–∂–∏—Ç—å –≤ –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏. ‚Äî –ò–æ–≥–∞–Ω–Ω –í–æ–ª—å—Ñ–≥–∞–Ω–≥ –ì—ë—Ç–µ.",
    "–õ–∏–¥–µ—Ä—ã –Ω–µ —Ä–æ–∂–¥–∞—é—Ç—Å—è –∏ –Ω–µ –¥–µ–ª–∞—é—Ç—Å—è –∫–µ–º-–ª–∏–±–æ ‚Äî –æ–Ω–∏ –¥–µ–ª–∞—é—Ç —Å–µ–±—è —Å–∞–º–∏. ‚Äî –°—Ç–∏–≤–µ–Ω –ö–æ–≤–∏.",
    "–ß–µ—Ä–µ–∑ 20 –ª–µ—Ç –≤—ã –±—É–¥–µ—Ç–µ –±–æ–ª—å—à–µ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω—ã —Ç–µ–º–∏ –≤–µ—â–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –Ω–µ –¥–µ–ª–∞–ª–∏, —á–µ–º —Ç–µ–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–¥–µ–ª–∞–ª–∏. –¢–∞–∫ –æ—Ç—á–∞–ª—å—Ç–µ –æ—Ç —Ç–∏—Ö–æ–π –ø—Ä–∏—Å—Ç–∞–Ω–∏. –ü–æ—á—É–≤—Å—Ç–≤—É–π—Ç–µ –ø–æ–ø—É—Ç–Ω—ã–π –≤–µ—Ç–µ—Ä –≤ –≤–∞—à–µ–º –ø–∞—Ä—É—Å–µ. –î–≤–∏–≥–∞–π—Ç–µ—Å—å –≤–ø–µ—Ä–µ–¥, –¥–µ–π—Å—Ç–≤—É–π—Ç–µ, –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ! ‚Äî –ì. –î–∂–µ–∫—Å–æ–Ω –ë—Ä–∞—É–Ω.",
    "–î–µ–ª–∞–π—Ç–µ, —á—Ç–æ –º–æ–∂–µ—Ç–µ, —Å —Ç–µ–º, —á—Ç–æ –∏–º–µ–µ—Ç–µ, —Ç–∞–º, –≥–¥–µ –≤—ã –µ—Å—Ç—å. ‚Äî –¢–µ–æ–¥–æ—Ä –†—É–∑–≤–µ–ª—å—Ç.",
    "–ù–µ –∂–¥–∏—Ç–µ; —Ç–æ—Ç —Å–∞–º—ã–π –º–æ–º–µ–Ω—Ç –Ω–µ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –Ω–∏–∫–æ–≥–¥–∞. ‚Äî –ù–∞–ø–æ–ª–µ–æ–Ω –•–∏–ª–ª.",
    "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –º–∏—Ä, –Ω–∞—á–Ω–∏—Ç–µ —Å —Å–µ–±—è. ‚Äî –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏.",
    "–ù–µ –ø–æ–∑–≤–æ–ª—è–π—Ç–µ –≤—á–µ—Ä–∞—à–Ω–µ–º—É –¥–Ω—é –∑–∞–Ω–∏–º–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º. ‚Äî –£–∏–ª–ª –†–æ–¥–∂–µ—Ä—Å.",
    "–ò–∑–º–µ–Ω–∏—Ç–µ —Å–≤–æ—é –∂–∏–∑–Ω—å —Å–µ–≥–æ–¥–Ω—è. –ù–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–π—Ç–µ –Ω–∞ –±—É–¥—É—â–µ–µ, –¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å–µ–π—á–∞—Å, –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—è. ‚Äî –°–∏–º–æ–Ω–∞ –¥–µ –ë–æ–≤—É–∞—Ä.",
    "–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—Ä–µ–¥–µ–ª–æ–º –Ω–∞—à–∏—Ö –∑–∞–≤—Ç—Ä–∞—à–Ω–∏—Ö —Å–≤–µ—Ä—à–µ–Ω–∏–π —Å—Ç–∞–Ω—É—Ç –Ω–∞—à–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —Å–æ–º–Ω–µ–Ω–∏—è. ‚Äî –§—Ä–∞–Ω–∫–ª–∏–Ω –î. –†—É–∑–≤–µ–ª—å—Ç.",
    "–î–µ–ª–∞–π —Å–µ–≥–æ–¥–Ω—è —Ç–æ, —á—Ç–æ –¥—Ä—É–≥–∏–µ –Ω–µ —Ö–æ—Ç—è—Ç ‚Äî –∑–∞–≤—Ç—Ä–∞ –±—É–¥–µ—à—å –∂–∏—Ç—å —Ç–∞–∫, –∫–∞–∫ –¥—Ä—É–≥–∏–µ –Ω–µ –º–æ–≥—É—Ç. ‚Äî –î–∂–∞—Ä–µ–¥ –õ–µ—Ç–æ.",
    "–ö—Ç–æ-—Ç–æ –æ—Ç–¥—ã—Ö–∞–µ—Ç —Å–µ–≥–æ–¥–Ω—è –≤ —Ç–µ–Ω–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫—Ç–æ-—Ç–æ –ø–æ—Å–∞–¥–∏–ª –¥–µ—Ä–µ–≤–æ –º–Ω–æ–≥–æ –ª–µ—Ç –Ω–∞–∑–∞–¥. ‚Äî –£–æ—Ä—Ä–µ–Ω –ë–∞—Ñ—Ñ–µ—Ç—Ç.",
    "–ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥ –∏ –Ω–∞—á–∞—Ç—å –≤—Å–µ —Å–Ω–∞—á–∞–ª–∞, –Ω–æ –ª—é–±–æ–π —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è –∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ. ‚Äî –°—ç–º—é—ç–ª –î–∂–æ–Ω—Å–æ–Ω.",
    "–ù–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ —á–∞—Å—ã; –¥–µ–ª–∞–π —Ç–æ, —á—Ç–æ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç. –ü—Ä–æ–¥–æ–ª–∂–∞–π –∏–¥—Ç–∏ –≤–ø–µ—Ä–µ–¥. ‚Äî –°—ç–º –õ–µ–≤–µ–Ω—Å–æ–Ω.",
    "–•—Ä–∞–±—Ä–æ—Å—Ç—å –Ω–µ –≤—Å–µ–≥–¥–∞ –∫—Ä–∏—á–∏—Ç. –ò–Ω–æ–≥–¥–∞ —Ö—Ä–∞–±—Ä–æ—Å—Ç—å –≥–æ–≤–æ—Ä–∏—Ç —Ç–∏—Ö–∏–º –≥–æ–ª–æ—Å–æ–º –≤ –∫–æ–Ω—Ü–µ –¥–Ω—è: –ó–∞–≤—Ç—Ä–∞ —è –ø–æ–ø—ã—Ç–∞—é—Å—å –µ—â–µ —Ä–∞–∑. ‚Äî –ú—ç—Ä–∏ –≠–Ω–Ω –†–µ–¥–º–∞—á–µ—Ä.",
    "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–º–µ—Ç—å —Ç–æ, —á—Ç–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–º–µ–ª–∏, –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å —Ç–æ, —á—Ç–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∞–ª–∏. ‚Äî –ö–æ–∫–æ –®–∞–Ω–µ–ª—å.",
    "–ö–∞–∂–¥—É—é –Ω–æ—á—å, –ø—Ä–µ–∂–¥–µ —á–µ–º —É—Å–Ω—É—Ç—å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å–µ–±–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –∑–∞–≤—Ç—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å. –í—ã —É–≤–∏–¥–∏—Ç–µ, –≤–æ –º–Ω–æ–≥–æ–º —Ç–∞–∫ –∏ –±—É–¥–µ—Ç. ‚Äî –ë—Ä–∞–π–∞–Ω –¢—Ä–µ–π—Å–∏.",
    "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ö–æ—Ä–æ—à–∏–º, –Ω–æ –µ—Å—Ç—å —á—Ç–æ-—Ç–æ —Ö–æ—Ä–æ—à–µ–µ –≤ –∫–∞–∂–¥–æ–º –¥–Ω–µ. ‚Äî –≠–ª–∏—Å –ú–æ—Ä–∑ –≠—Ä–ª.",
    "–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π —É–ø—É—Å–∫–∞—é—Ç —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –±—ã–≤–∞–µ—Ç –æ–¥–µ—Ç–∞ –≤ –∫–æ–º–±–∏–Ω–µ–∑–æ–Ω –∏ —Å –≤–∏–¥—É –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É. ‚Äî –¢–æ–º–∞—Å –≠–¥–∏—Å–æ–Ω.",
    "–í—ã —Ö–æ—Ç–∏—Ç–µ –∑–Ω–∞—Ç—å, –∫—Ç–æ –≤—ã? –ù–µ —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ. –î–µ–π—Å—Ç–≤—É–π—Ç–µ! –î–µ–π—Å—Ç–≤–∏–µ –±—É–¥–µ—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å –∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–∞—Å. ‚Äî –¢–æ–º–∞—Å –î–∂–µ—Ñ—Ñ–µ—Ä—Å–æ–Ω.",
    "–í—ã –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∞—Ç—å —Ç–æ, —á—Ç–æ, –∫–∞–∫ –≤–∞–º –∫–∞–∂–µ—Ç—Å—è, –≤—ã –Ω–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–¥–µ–ª–∞—Ç—å. ‚Äî –≠–ª–µ–æ–Ω–æ—Ä–∞ –†—É–∑–≤–µ–ª—å—Ç.",
    "–î–∞–∂–µ –µ—Å–ª–∏ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏, –≤–∞—Å —Å–æ–±—å—é—Ç, –µ—Å–ª–∏ –≤—ã –ø—Ä–æ—Å—Ç–æ —Å–∏–¥–∏—Ç–µ —Ç–∞–º. ‚Äî –£–∏–ª–ª –†–æ–¥–∂–µ—Ä—Å.",
    "–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –Ω–∞ –ø—É—Ç–∏ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—á—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å. ‚Äî –≠–Ω—Ç–æ–Ω–∏ –†–æ–±–±–∏–Ω—Å.",
    "–ì–ª–∞–≤–Ω–æ–µ, –Ω–µ —Å—Ö–æ–¥–∏—Ç–µ —Å –ø—É—Ç–∏ –∏ –Ω–µ —Å–¥–∞–≤–∞–π—Ç–µ—Å—å. –¢–∞–º, –≥–¥–µ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –ª—é–±–æ–≤—å –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, —è –¥—É–º–∞—é, –Ω–µ–ª—å–∑—è –æ—à–∏–±–∏—Ç—å—Å—è. ‚Äî –≠–ª–ª–∞ –î–∂–µ–π–Ω –§–∏—Ü–¥–∂–µ—Ä–∞–ª—å–¥.",
    "–í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –º—ã –º–æ–∂–µ–º –≤—ã–Ω–µ—Å—Ç–∏ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ, —á–µ–º –º—ã –¥—É–º–∞–µ–º. ‚Äî –§—Ä–∏–¥–∞ –ö–∞–ª–æ.",
    "–î–µ–π—Å—Ç–≤–∏—è –Ω–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–Ω–æ—Å—è—Ç —Å—á–∞—Å—Ç—å–µ, –Ω–æ –Ω–µ –±—ã–≤–∞–µ—Ç —Å—á–∞—Å—Ç—å—è –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏—è. ‚Äî –ë–µ–Ω–¥–∂–∞–º–∏–Ω –î–∏–∑—Ä–∞—ç–ª–∏.",
    "–ï—Å–ª–∏ –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –Ω–∞–¥ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ü–µ–ª—è–º–∏, —Ç–æ —ç—Ç–∏ —Ü–µ–ª–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤–∞—Å. ‚Äî –î–∂–∏–º –†–æ–Ω.",
    "–ö–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä, –∞ –≤—ã –µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç–µ, ‚Äî —ç—Ç–æ —Ç–æ–∂–µ –≤—ã–±–æ—Ä. ‚Äî –£–∏–ª—å—è–º –î–∂–µ–π–º—Å.",
    "–ú—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –º—É–¥—Ä–æ –∏ –ø–æ–º–Ω–∏—Ç—å: –ø—Ä–∞–≤–æ–µ –¥–µ–ª–æ –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –≤ –ª—é–±—É—é –º–∏–Ω—É—Ç—É. ‚Äî –ù–µ–ª—å—Å–æ–Ω –ú–∞–Ω–¥–µ–ª–∞.",
    "–°—Ç—Ä–µ–º–∏—Ç–µ—Å—å –Ω–µ –∫ —É—Å–ø–µ—Ö—É, –∞ –∫ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –¥–∞–µ—Ç. ‚Äî –ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω.",
    "–õ–æ–≥–∏–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –≤–∞—Å –æ—Ç –ø—É–Ω–∫—Ç–∞ –ê –∫ –ø—É–Ω–∫—Ç—É –ë, –∞ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –∫—É–¥–∞ —É–≥–æ–¥–Ω–æ. ‚Äî –ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω.",
    "–í–∞—à–µ –≤—Ä–µ–º—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ, –Ω–µ —Ç—Ä–∞—Ç—å—Ç–µ –µ–≥–æ, –∂–∏–≤—è —á—É–∂–æ–π –∂–∏–∑–Ω—å—é. ‚Äî –°—Ç–∏–≤ –î–∂–æ–±—Å.",
    "–ù–µ–≤–∞–∂–Ω–æ, –∫–∞–∫ –º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã –∏–¥–µ—Ç–µ, –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –≤—ã –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å. ‚Äî –ö–æ–Ω—Ñ—É—Ü–∏–π.",
    "–ü—É—Ç—å –≤ —Ç—ã—Å—è—á—É –ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞. ‚Äî –õ–∞–æ-—Ü–∑—ã.",
    "–¢—Ä—É–¥–Ω–æ—Å—Ç–∏ —É–∫—Ä–µ–ø–ª—è—é—Ç —É–º, –∫–∞–∫ —Ç—Ä—É–¥ —É–∫—Ä–µ–ø–ª—è–µ—Ç —Ç–µ–ª–æ. ‚Äî –°–µ–Ω–µ–∫–∞.",
    "–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞, –Ω–æ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –ø–æ–¥–Ω—è—Ç—å –ø–∞—Ä—É—Å–∞, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Å–≤–æ–µ–π —Ü–µ–ª–∏. ‚Äî –û—Å–∫–∞—Ä –£–∞–π–ª—å–¥.",
    "–í–µ—Ä–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–∞—á–∞—Ç—å —á—Ç–æ-—Ç–æ ‚Äî –±—Ä–æ—Å–∏—Ç—å –≥–æ–≤–æ—Ä–∏—Ç—å –∏ –¥–µ–ª–∞—Ç—å. ‚Äî –£–æ–ª—Ç –î–∏—Å–Ω–µ–π.",
    "–ü—Ä–æ–π–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å –∏ –µ—Å—Ç—å –Ω–∞–≥—Ä–∞–¥–∞. ‚Äî –°—Ç–∏–≤ –î–∂–æ–±—Å.",
    "–ï—Å–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –º–µ—á—Ç–∞—Ç—å, —Ç–æ –º–æ–∂–µ—Ç–µ –∏ –≤–æ–ø–ª–æ—Ç–∏—Ç—å —Å–≤–æ–∏ –º–µ—á—Ç—ã –≤ –∂–∏–∑–Ω—å. ‚Äî –£–æ–ª—Ç –î–∏—Å–Ω–µ–π.",
    "–£–º–µ–Ω–∏–µ –∂–∏—Ç—å ‚Äî —Å–∞–º–∞—è —Ä–µ–¥–∫–∞—è –≤–µ—â—å –≤ –º–∏—Ä–µ. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π –ø—Ä–æ—Å—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. ‚Äî –û—Å–∫–∞—Ä –£–∞–π–ª—å–¥.",
    "–¢–æ, —á—Ç–æ –º—ã –ª—é–±–∏–º, –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º –æ —Ç–æ–º, –∫—Ç–æ –º—ã –µ—Å—Ç—å. ‚Äî –§–æ–º–∞ –ê–∫–≤–∏–Ω—Å–∫–∏–π.",
    "–ö–æ–≥–¥–∞ –≤–∞–º –ø–æ–∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —Ü–µ–ª—å –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–∞, –Ω–µ –∏–∑–º–µ–Ω—è–π—Ç–µ —Ü–µ–ª—å ‚Äî –∏–∑–º–µ–Ω—è–π—Ç–µ —Å–≤–æ–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π. ‚Äî –ö–æ–Ω—Ñ—É—Ü–∏–π.",
    "–ë—É–¥—å—Ç–µ —Å–æ–±–æ–π. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–æ–ª–∏ —É–∂–µ –∑–∞–Ω—è—Ç—ã. ‚Äî –û—Å–∫–∞—Ä –£–∞–π–ª—å–¥.",
    "–õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ü–µ–ª–∏, —á–µ–º –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å. ‚Äî –°–æ–∫—Ä–∞—Ç.",
    "–ü—Ä–æ—Å—ã–ø–∞—è—Å—å —É—Ç—Ä–æ–º, —Å–ø—Ä–æ—Å–∏ —Å–µ–±—è: –ß—Ç–æ —è –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å? –í–µ—á–µ—Ä–æ–º, –ø—Ä–µ–∂–¥–µ —á–µ–º –∑–∞—Å–Ω—É—Ç—å: –ß—Ç–æ —è —Å–¥–µ–ª–∞–ª? ‚Äî –ü–∏—Ñ–∞–≥–æ—Ä.",
    "–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –¥–∞–∂–µ —Å–∞–º—ã–π —Ç—è–∂–µ–ª—ã–π —á–∞—Å –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ ‚Äî –≤—Å–µ–≥–æ 60 –º–∏–Ω—É—Ç. ‚Äî –°–æ—Ñ–æ–∫–ª.",
    "–•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –Ω–µ —Å –Ω–µ–±–∞ –ø–∞–¥–∞–µ—Ç, –∞ –º—ã –µ–≥–æ –¥–µ–ª–∞–µ–º, –æ–Ω–æ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–µ—Ä–¥—Ü–µ –Ω–∞—à–µ–º. ‚Äî –§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π.",
    "–°–µ–∫—Ä–µ—Ç –ø–µ—Ä–µ–º–µ–Ω —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ, –∞ –Ω–µ –Ω–∞ –±–æ—Ä—å–±–µ —Å–æ —Å—Ç–∞—Ä—ã–º. ‚Äî –°–æ–∫—Ä–∞—Ç.",
    "–ï—Å–ª–∏ –≤—ã —Ä–µ—à–∏–ª–∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –∑–∞–∫—Ä–æ–π—Ç–µ –¥–≤–µ—Ä–∏ –¥–ª—è —Å–æ–º–Ω–µ–Ω–∏–π. ‚Äî –§—Ä–∏–¥—Ä–∏—Ö –ù–∏—Ü—à–µ.",
    "–í—ã–∂–∏–≤–∞–µ—Ç –Ω–µ —Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π –∏–∑ –≤–∏–¥–æ–≤ –∏ –Ω–µ —Å–∞–º—ã–π —É–º–Ω—ã–π, –∞ —Ç–æ—Ç, –∫—Ç–æ –ª—É—á—à–µ –¥—Ä—É–≥–∏—Ö —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è. ‚Äî –õ–µ–æ–Ω –ú–µ–≥–≥–∏–Ω—Å–æ–Ω.",
    "–ß–µ–ª–æ–≤–µ–∫ –≤—Å—é –∂–∏–∑–Ω—å –Ω–µ –∂–∏–≤–µ—Ç, –∞ —Å–æ—á–∏–Ω—è–µ—Ç —Å–µ–±—è, —Å–∞–º–æ—Å–æ—á–∏–Ω—è–µ—Ç—Å—è. ‚Äî –§—ë–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π.",
    "–ë—É–¥—å —á–µ—Å—Ç–µ–Ω —Å —Å–∞–º–∏–º —Å–æ–±–æ–π, –∏ —Å –ª—é–¥—å–º–∏, –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π –≤—Å–µ –≤–æ–≤—Ä–µ–º—è, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–¥–∞–≤–∞–π—Å—è, –∏–¥–∏ –∫ —Å–≤–æ–∏–º —Ü–µ–ª—è–º, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Å–µ –ø–ª–æ—Ö–æ. ‚Äî –°—Ç–∏–≤ –î–∂–æ–±—Å.",
    "–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—É—Ç—å –∫ —Å—á–∞—Å—Ç—å—é ‚Äî –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ –≤–µ—â–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–≤–ª–∞—Å—Ç–Ω—ã –Ω–∞—à–µ–π –≤–æ–ª–µ. ‚Äî –≠–ø–∏–∫—Ç–µ—Ç.",
    "–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π –≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ —Ö–æ—Ç—è—Ç —Å–≤–æ–±–æ–¥—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π —Å—Ç—Ä–∞—à–∏—Ç. ‚Äî –ó–∏–≥–º—É–Ω–¥ –§—Ä–µ–π–¥.",
    "–î–µ–π—Å—Ç–≤–∏–µ –¥–∞–∂–µ —Å–∞–º–æ–≥–æ –∫—Ä–æ—Ö–æ—Ç–Ω–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤–æ –≤—Å–µ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π. ‚Äî –ù–∏–∫–æ–ª–∞ –¢–µ—Å–ª–∞.",
    "–ü–æ–±–µ–¥–∞ ‚Äî —ç—Ç–æ –µ—â–µ –Ω–µ –≤—Å–µ, –≤—Å–µ ‚Äî —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ –ø–æ–±–µ–∂–¥–∞—Ç—å. ‚Äî –í–∏–Ω—Å –õ–æ–º–±–∞—Ä–¥–∏.",
    "–ù–µ –±—É–¥—É—á–∏ –≤ —Å–∏–ª–∞—Ö —Å–≤–µ—Ä—à–∏—Ç—å –≤–µ–ª–∏–∫–æ–µ, —Å–≤–µ—Ä—à–∞–π –º–∞–ª–æ–µ –≤–µ–ª–∏–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º. ‚Äî –ù–∞–ø–æ–ª–µ–æ–Ω –•–∏–ª–ª.",
    "–ü—Ä–µ–¥—Ä–∞—Å—Å—É–¥–∫–∏ ‚Äî —ç—Ç–æ –±—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—É—Ç–∞–µ—Ç –ø—Ä–æ—à–ª–æ–µ, —Å—Ç–∞–≤–∏—Ç –ø–æ–¥ —É–≥—Ä–æ–∑—É –±—É–¥—É—â–µ–µ –∏ –¥–µ–ª–∞–µ—Ç –Ω–∞—Å—Ç–æ—è—â–µ–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏. ‚Äî –ú–∞–π—è –ê–Ω–∂–µ–ª—É.",
    "–ì—Ä–∞–º–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ —Å—Ç–æ–∏—Ç –¥–æ—Ä–æ–∂–µ —Ç–æ–Ω–Ω—ã —á—É–∂–∏—Ö –Ω–∞—Å—Ç–∞–≤–ª–µ–Ω–∏–π. ‚Äî –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏.",
    "–ù–µ —Å—Ç–æ–∏—Ç –±—ã—Ç—å —Ç–µ–Ω—å—é –≤ —á—É–∂–æ–º —Ñ–æ–Ω–∞—Ä–µ, –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å–∏—è—Ç—å —Å–≤–æ–∏–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–≤–µ—Ç–æ–º. ‚Äî –ê–ª–µ–∫—Å–µ–π –•—Ä–∏—Å—Ç–∏–Ω–∏–Ω.",
    "–í—ã –Ω–µ —Å–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Å–µ—á—å –º–æ—Ä–µ, –ø—Ä–æ—Å—Ç–æ —Å—Ç–æ—è –∏ –≤–≥–ª—è–¥—ã–≤–∞—è—Å—å –≤ –≤–æ–¥—É. –ù–µ —Ç—Ä–∞—Ç—å—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –Ω–∞–ø—Ä–∞—Å–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è. ‚Äî –†–∞–±–∏–Ω–¥—Ä–∞–Ω–∞—Ç –¢–∞–≥–æ—Ä.",
    "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥—Ä—É–∂–∏—Ç–µ —Å —Ç–µ–º–∏, –∫—Ç–æ –ª—É—á—à–µ –≤–∞—Å. –ë—É–¥–µ—Ç–µ –º—É—á–∏—Ç—å—Å—è, –Ω–æ —Ä–∞—Å—Ç–∏. ‚Äî –í–µ—Ä–∞ –ü–æ–ª–æ–∑–∫–æ–≤–∞.",
    "–ü–ª–∞–Ω—ã ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞–±–æ—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏–π. –ï—Å–ª–∏ –æ–Ω–∏ —Ç—É—Ç –∂–µ –Ω–µ –ø–µ—Ä–µ—Ä–∞—Å—Ç–∞—é—Ç –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≤–∞—à–∏—Ö —Ü–µ–ª–µ–π. –ù–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∫–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–∞—è –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –±—É–¥–µ—Ç –ø–æ—Ç–æ–º —ç–∫–æ–Ω–æ–º–∏—Ç—å –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–µ–Ω–µ–≥. ‚Äî –î–º–∏—Ç—Ä–∏–π –ë—Ä–µ–π—Ç–µ–Ω–±–∏—Ö–µ—Ä.",
    "–°–≤–æ–±–æ–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Å—Ç–æ–∏—Ç, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å–≤–æ–±–æ–¥—É –æ—à–∏–±–∞—Ç—å—Å—è. ‚Äî –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏.",
    "–ù–µ –±–æ–π—Ç–µ—Å—å –æ—Ç–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ—Ç —Ö–æ—Ä–æ—à–µ–≥–æ –≤ –ø–æ–ª—å–∑—É –æ—Ç–ª–∏—á–Ω–æ–≥–æ. ‚Äî –î–∂–æ–Ω –†–æ–∫—Ñ–µ–ª–ª–µ—Ä.",
    "–ú—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º—è, –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∞ –Ω–µ –∫–∞–∫ –¥–∏–≤–∞–Ω. ‚Äî –î–∂–æ–Ω –§–∏—Ü–¥–∂–µ—Ä–∞–ª—å–¥ –ö–µ–Ω–Ω–µ–¥–∏.",
    "–ú—ã —Å–≤–æ–±–æ–¥–Ω—ã –≤—ã–±–∏—Ä–∞—Ç—å –Ω–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ –º—ã –Ω–µ –º–æ–∂–µ–º –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —ç—Ç–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. ‚Äî –°—Ç–∏–≤–µ–Ω –ö–æ–≤–∏.",
    "–õ—É—á—à–µ –ø–æ—Ç–µ—Ä–ø–µ—Ç—å –Ω–µ—É–¥–∞—á—É –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, —á–µ–º –ø—Ä–µ—É—Å–ø–µ—Ç—å –≤ –ø–æ–¥—Ä–∞–∂–∞–Ω–∏–∏. ‚Äî –ì–µ—Ä–º–∞–Ω –ú–µ–ª–≤–∏–ª–ª.",
    "–ú—ã –º–æ–∂–µ–º —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–±–µ–∂–¥–µ–Ω–Ω—ã–º–∏. ‚Äî –ú–∞–π—è –ê–Ω–∂–µ–ª—É.",
    "–ë–æ–ª—å—à—É—é —Ä–∞–±–æ—Ç—É –ø–æ—Ä—É—á–∞—é—Ç —Ç–æ–º—É, –∫—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ä–∞—Å—Ç–∏ –º–∞–ª–µ–Ω—å–∫—É—é. ‚Äî –¢–µ–æ–¥–æ—Ä –†—É–∑–≤–µ–ª—å—Ç.",
    "–í—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç–µ —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã, —á—Ç–æ–±—ã —Å—Ç–∞–≤–∏—Ç—å –¥—Ä—É–≥—É—é —Ü–µ–ª—å –∏–ª–∏ –º–µ—á—Ç–∞—Ç—å –æ –Ω–æ–≤–æ–π –º–µ—á—Ç–µ. ‚Äî –ö–ª–∞–π–≤ –°—Ç–µ–π–ø–ª–∑ –õ—å—é–∏—Å.",
    "–ù–µ –æ—Ç—Å—Ç—É–ø–∞–π –ø–µ—Ä–µ–¥ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏. –°–º–æ—Ç—Ä–∏ –∏–º –ø—Ä—è–º–æ –≤ –ª–∏—Ü–æ. –°–º–æ—Ç—Ä–∏, –ø–æ–∫–∞ –Ω–µ –æ–¥–æ–ª–µ–µ—à—å –∏—Ö. ‚Äî –ß–∞—Ä–ª—å–∑ –î–∏–∫–∫–µ–Ω—Å.",
    "–ß–µ–º –±–æ–ª—å—à–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π –º—ã –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞–µ–º, —Ç–µ–º –ª–µ–≥—á–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º —Å–≤–æ–µ –±—É–¥—É—â–µ–µ. ‚Äî –ú–∞–π–∫–ª –•–∞–π—è—Ç—Ç.",
    "–í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞: —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –≤–ø–µ—Ä–µ–¥ –∫ —Ä–æ—Å—Ç—É –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ. ‚Äî –ê–±—Ä–∞—Ö–∞–º –ú–∞—Å–ª–æ—É.",
    "–ù–µ —Å–ª—É—à–∞–π—Ç–µ —Ç–µ—Ö, –∫—Ç–æ –≤–µ–ª–∏—Ç –∏–≥—Ä–∞—Ç—å –Ω–∞ —Å–∫—Ä–∏–ø–∫–µ, –∫–æ–≥–¥–∞ –≤—ã –æ—Ç–ª–∏—á–Ω–æ –∏–≥—Ä–∞–µ—Ç–µ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω–∞—Ö. ‚Äî –ñ–æ–∑–µ –ú–æ—É—Ä–∏–Ω—å—é.",
    "–ù–µ–ª—å–∑—è –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—É—é –∑–µ–º–ª—é, –Ω–µ —Å–æ–≥–ª–∞—Å–∏–≤—à–∏—Å—å —Å–Ω–∞—á–∞–ª–∞ –∏ –Ω–∞–¥–æ–ª–≥–æ –ø–æ—Ç–µ—Ä—è—Ç—å –∏–∑ –≤–∏–¥—É –ª—é–±–æ–π –±–µ—Ä–µ–≥. ‚Äî –ê–Ω–¥—Ä–µ –ñ–∏–¥.",
    "–í—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–µ–ª–∏–∫–∏–º–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å, –Ω–æ –≤—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∞—Ç—å, —á—Ç–æ–±—ã –±—ã—Ç—å –≤–µ–ª–∏–∫–∏–º–∏. ‚Äî –ó–∏–≥ –ó–∏–≥–ª–∞—Ä.",
    "–í—Å–µ —Ç–æ, —á—Ç–æ –ª–µ–∂–∏—Ç –ø–æ–∑–∞–¥–∏ –Ω–∞—Å –∏ —á—Ç–æ –ª–µ–∂–∏—Ç –ø–µ—Ä–µ–¥ –Ω–∞–º–∏, ‚Äî –º–µ–ª–æ—á–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç–µ–º, —á—Ç–æ –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –Ω–∞—Å. ‚Äî –†–∞–ª—å—Ñ –£–æ–ª–¥–æ –≠–º–µ—Ä—Å–æ–Ω.",
    "–¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏–µ –≤–µ–ª–∏–∫–∏—Ö —Ü–µ–ª–µ–π —á–µ–ª–æ–≤–µ–∫ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤ —Å–µ–±–µ –≤–µ–ª–∏–∫–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä, –¥–µ–ª–∞—é—â–∏–π –µ–≥–æ –º–∞—è–∫–æ–º –¥–ª—è –¥—Ä—É–≥–∏—Ö. ‚Äî –ì–µ–æ—Ä–≥ –ì–µ–≥–µ–ª—å.",
    "–í–µ–ª–∏—á–∞–π—à–∞—è –ø–æ–ª—å–∑–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –∏–∑ –∂–∏–∑–Ω–∏, ‚Äî –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –∂–∏–∑–Ω—å –Ω–∞ –¥–µ–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–∂–∏–≤—ë—Ç –Ω–∞—Å. ‚Äî –£–∏–ª—å—è–º –î–∂–µ–π–º—Å.",
    "–ö–æ–≥–¥–∞ —á–µ–ª–æ–≤–µ–∫—É –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –≤—Å—ë –∏–¥—ë—Ç –Ω–∞–ø–µ—Ä–µ–∫–æ—Å—è–∫, –≤ –µ–≥–æ –∂–∏–∑–Ω—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤–æ–π—Ç–∏ –Ω–µ—á—Ç–æ —á—É–¥–µ—Å–Ω–æ–µ. ‚Äî –î–∞–ª–∞–π-–ª–∞–º–∞ XIV.",
    "–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–π—Ç–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –¥–Ω—è, –Ω–µ –æ–∫–∞–∑–∞–≤ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –º–∏—Ä –≤–æ–∫—Ä—É–≥ –≤–∞—Å. –¢–æ, —á—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ, –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ –≤—ã –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∏—Ç—å, –∫–∞–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –±—É–¥—É—Ç –∏–º–µ—Ç—å –≤–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è. ‚Äî –î–∂–µ–π–Ω –ì—É–¥–æ–ª–ª.",
    "–í—ã –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–∏—Ç—å –≤ —Å–µ–±—è –¥–∞–∂–µ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤ –≤–∞—Å —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è –≤–µ—Å—å –º–∏—Ä. ‚Äî –®—Ä–∏ –ß–∏–Ω–º–æ–π.",
    "–û—Ç–¥–∞–≤–∞–π –º–∏—Ä—É –ª—É—á—à–µ–µ, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å, –∏ –ª—É—á—à–µ–µ —É—Å—Ç—Ä–µ–º–∏—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –∫ —Ç–µ–±–µ. ‚Äî –®—Ä–∏ –ß–∏–Ω–º–æ–π.",
    "–í–æ–∑—å–º–∏—Ç–µ –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–≤–æ—é –∂–∏–∑–Ω—å. –ó–Ω–∞–π—Ç–µ, —á—Ç–æ —Ç–æ–ª—å–∫–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–µ–±—è —Ç—É–¥–∞, –∫—É–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ, –∏ –Ω–∏–∫—Ç–æ –±–æ–ª—å—à–µ. ‚Äî –õ–µ—Å –ë—Ä–∞—É–Ω.",
    "–ñ–∏–∑–Ω—å ‚Äî —ç—Ç–æ 10 –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ç–æ–≥–æ, —á—Ç–æ —Å –≤–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∏ 90 –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –Ω–∞ —ç—Ç–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç–µ. ‚Äî –õ—É –•–æ–ª—å—Ü.",
    "–¢–æ–ª—å–∫–æ —è –º–æ–≥—É –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å. –ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∑–∞ –º–µ–Ω—è. ‚Äî –ö—ç—Ä–æ–ª –ë–µ—Ä–Ω–µ—Ç—Ç.",
    "–°–º—ã—Å–ª –∂–∏–∑–Ω–∏ –Ω–µ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∂–¥–∞—Ç—å, –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è –≥—Ä–æ–∑–∞, –∞ –≤ —Ç–æ–º, —á—Ç–æ–±—ã —É—á–∏—Ç—å—Å—è —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å –ø–æ–¥ –¥–æ–∂–¥–µ–º. ‚Äî –í–∏–≤–∏–∞–Ω –ì—Ä–∏–Ω.",
    "–ú—ã –Ω–∞—Ö–æ–¥–∏–º –≤ –∂–∏–∑–Ω–∏ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Å–∞–º–∏ –≤–∫–ª–∞–¥—ã–≤–∞–µ–º –≤ –Ω–µ–µ. ‚Äî –†–∞–ª—å—Ñ –£–æ–ª–¥–æ –≠–º–µ—Ä—Å–æ–Ω.",
    "–¢–æ, —á—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª, –∏ –≤—ã –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∏—Ç—å, –∫–∞–∫–∏–º —Å–º—ã—Å–ª–æ–º –Ω–∞–ø–æ–ª–Ω–∏—Ç—å –∂–∏–∑–Ω—å. ‚Äî –î–∂–µ–π–Ω –ì—É–¥–æ–ª–ª.",
    "–ñ–∏–∑–Ω—å ‚Äî —ç—Ç–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ, –∞ –Ω–µ –ø—É–Ω–∫—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è. ‚Äî –†–∞–ª—å—Ñ –£–æ–ª–¥–æ –≠–º–µ—Ä—Å–æ–Ω.",
    "–ñ–∏–∑–Ω—å —Å–æ—Å—Ç–æ–∏—Ç –Ω–µ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å–µ–±—è. –ñ–∏–∑–Ω—å —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å–µ–±—è. ‚Äî –î–∂–æ—Ä–¥–∂ –ë–µ—Ä–Ω–∞—Ä–¥ –®–æ—É.",
    "–ù–∏ —Ä–∞–∑—É –Ω–µ —É–ø–∞—Å—Ç—å ‚Äî –Ω–µ —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –∑–∞—Å–ª—É–≥–∞ –≤ –∂–∏–∑–Ω–∏. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è. ‚Äî –ù–µ–ª—å—Å–æ–Ω –ú–∞–Ω–¥–µ–ª–∞.",
    "–°—Ç–∞–Ω—å —Å–∞–º —Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–æ–π, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—á–µ—à—å —É–≤–∏–¥–µ—Ç—å –≤ –º–∏—Ä–µ. ‚Äî –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏.",
    "–ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ, —á—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –≤—Å—ë –≤ –∂–∏–∑–Ω–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—Å—ë —Ü–∏–∫–ª–∏—á–Ω–æ. ‚Äî –ò–≤–∞–Ω –ü—å—è–Ω–æ–≤.",
    "–õ—É—á—à–∏–µ –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω–µ–π—à–∏–µ –≤–µ—â–∏ –≤ –º–∏—Ä–µ –Ω–µ–ª—å–∑—è —É–≤–∏–¥–µ—Ç—å, –∫ –Ω–∏–º –Ω–µ–ª—å–∑—è –¥–∞–∂–µ –ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è. –ò—Ö –Ω–∞–¥–æ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ—Ä–¥—Ü–µ–º. ‚Äî –•–µ–ª–µ–Ω –ê–¥–∞–º—Å –ö–µ–ª–ª–µ—Ä.",
    "–í—á–µ—Ä–∞ —è –±—ã–ª —É–º–Ω—ã–º, —Ö–æ—Ç–µ–ª –∏–∑–º–µ–Ω–∏—Ç—å –º–∏—Ä. –°–µ–≥–æ–¥–Ω—è —è –º—É–¥—Ä—ã–π, –∏ –ø–æ—ç—Ç–æ–º—É –º–µ–Ω—è—é —Å–µ–±—è. ‚Äî –®—Ä–∏ –ß–∏–Ω–º–æ–π.",
    "–ü–æ–±–µ–¥—ã –Ω–µ –¥–µ–ª–∞—é—Ç –≤–∞—Å —Å–∏–ª—å–Ω–µ–µ. –°–∏–ª–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ –±–æ—Ä—å–±–µ. –ö–æ–≥–¥–∞, –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—è —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏, –≤—ã —Ä–µ—à–∞–µ—Ç–µ –Ω–µ —Å–¥–∞–≤–∞—Ç—å—Å—è ‚Äî —Ç–æ–≥–¥–∞ –≤—ã –ø—Ä–æ—è–≤–ª—è–µ—Ç–µ —Å–∏–ª—É. ‚Äî –ê—Ä–Ω–æ–ª—å–¥ –®–≤–∞—Ä—Ü–µ–Ω–µ–≥–≥–µ—Ä.",
    "–ö–∞–∂–¥—ã–π —á–µ–ª–æ–≤–µ–∫ –Ω–∞ –∑–µ–º–ª–µ, —á–µ–º –±—ã –æ–Ω –Ω–∏ –∑–∞–Ω–∏–º–∞–ª—Å—è, –∏–≥—Ä–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Ä–æ–ª—å –≤ –∏—Å—Ç–æ—Ä–∏–∏ –º–∏—Ä–∞. –ò –æ–±—ã—á–Ω–æ –¥–∞–∂–µ –Ω–µ –∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º. ‚Äî –ü–∞—É–ª–æ –ö–æ—ç–ª—å–æ.",
    "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–ø—É—Å–∫–∞–π—Ç–µ –≥–æ–ª–æ–≤—É. –î–µ—Ä–∂–∏—Ç–µ –µ—ë –≤—ã—Å–æ–∫–æ. –°–º–æ—Ç—Ä–∏—Ç–µ –º–∏—Ä—É –ø—Ä—è–º–æ –≤ –≥–ª–∞–∑–∞. ‚Äî –•–µ–ª–µ–Ω –ê–¥–∞–º—Å –ö–µ–ª–ª–µ—Ä.",
    "–°—Ç—Ä–∞—Ö –ø–æ–±–µ–∂–¥–∞–µ—Ç –±–æ–ª—å—à–µ –ª—é–¥–µ–π, —á–µ–º –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –≤–µ—â—å –≤ –º–∏—Ä–µ. ‚Äî –†–∞–ª—å—Ñ –£–æ–ª–¥–æ –≠–º–µ—Ä—Å–æ–Ω.",
    "–ó–∞ —Å–≤–æ—é –∫–∞—Ä—å–µ—Ä—É —è –ø—Ä–æ–ø—É—Å—Ç–∏–ª –±–æ–ª–µ–µ 9000 –±—Ä–æ—Å–∫–æ–≤, –ø—Ä–æ–∏–≥—Ä–∞–ª –ø–æ—á—Ç–∏ 300 –∏–≥—Ä. 26 —Ä–∞–∑ –º–Ω–µ –¥–æ–≤–µ—Ä—è–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ–±–µ–¥–Ω—ã–π –±—Ä–æ—Å–æ–∫, –∏ —è –ø—Ä–æ–º–∞—Ö–∏–≤–∞–ª—Å—è. –Ø —Ç–µ—Ä–ø–µ–ª –ø–æ—Ä–∞–∂–µ–Ω–∏—è —Å–Ω–æ–≤–∞, –∏ —Å–Ω–æ–≤–∞, –∏ —Å–Ω–æ–≤–∞. –ò –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —è –¥–æ–±–∏–ª—Å—è —É—Å–ø–µ—Ö–∞. ‚Äî –ú–∞–π–∫–ª –î–∂–æ—Ä–¥–∞–Ω.",
    "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ —É–º–µ–Ω–∏–µ –¥–≤–∏–≥–∞—Ç—å—Å—è –æ—Ç –Ω–µ—É–¥–∞—á–∏ –∫ –Ω–µ—É–¥–∞—á–µ, –Ω–µ —Ç–µ—Ä—è—è —ç–Ω—Ç—É–∑–∏–∞–∑–º–∞. ‚Äî –£–∏–Ω—Å—Ç–æ–Ω –ß–µ—Ä—á–∏–ª–ª—å.",
    "–£—Å–ø–µ—Ö –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ —Å—á–∞—Å—Ç—å—é. –°—á–∞—Å—Ç—å–µ –∂–µ ‚Äî —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É. –ï—Å–ª–∏ –í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–æ, —á–µ–º –í—ã –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å ‚Äî –í—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±—å–µ—Ç–µ—Å—å —É—Å–ø–µ—Ö–∞. ‚Äî –ê–ª—å–±–µ—Ä—Ç –®–≤–µ–π—Ü–µ—Ä.",
    "–ú–Ω–æ–≥–∏–µ –∏–∑ —Ç–µ—Ö, –∫—Ç–æ —Ç–µ—Ä–ø–∏—Ç –Ω–µ—É–¥–∞—á—É –≤ –∂–∏–∑–Ω–∏, ‚Äî —ç—Ç–æ –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ—Å–æ–∑–Ω–∞–≤–∞–ª–∏, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∏ –±—ã–ª–∏ –±–ª–∏–∑–∫–∏ –∫ —É—Å–ø–µ—Ö—É, –∫–æ–≥–¥–∞ –æ–Ω–∏ —Å–¥–∞–ª–∏—Å—å. ‚Äî –¢–æ–º–∞—Å –≠–¥–∏—Å–æ–Ω.",
    "–£—Å–ø–µ—Ö –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –≥—Ä—É–±—ã—Ö –æ—à–∏–±–æ–∫, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑. ‚Äî –î–∂–æ—Ä–¥–∂ –ë–µ—Ä–Ω–∞—Ä–¥ –®–æ—É.",
    "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –º–µ–ª–∫–∏—Ö —É—Å–∏–ª–∏–π, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –¥–µ–Ω—å –∑–∞ –¥–Ω–µ–º. ‚Äî –†–æ–±–µ—Ä—Ç –ö–æ–ª—å–µ—Ä.",
    "–£—Å–ø–µ—Ö –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫ –≤–∞–º. –≠—Ç–æ –≤—ã –∏–¥–µ—Ç–µ –∫ –Ω–µ–º—É. ‚Äî –ú–∞—Ä–≤–∞ –ö–æ–ª–ª–∏–Ω–∑.",
    "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤ —á–µ–º-—Ç–æ –ø—Ä–µ—É—Å–ø–µ—Ç—å, —Å—Ç–æ–∏—Ç –∏—Å–∫–∞—Ç—å –Ω–æ–≤—ã–µ –ø—É—Ç–∏, –∞ –Ω–µ –∏–¥—Ç–∏ –ø—Ä–æ—Ç–æ—Ä–µ–Ω–Ω—ã–º–∏ –ø—É—Ç—è–º–∏ —É–∂–µ –∫–µ–º-—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–≥–æ —É—Å–ø–µ—Ö–∞. ‚Äî –î–∂–æ–Ω –†–æ–∫—Ñ–µ–ª–ª–µ—Ä.",
    "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç –≤—ã–∂–∏—Ç—å. –°–∞–º–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –≤–∞—Å –∫ —É—Å–ø–µ—Ö—É. ‚Äî –î–∂–∏–º –†–æ–Ω.",
    "–£—Å–ø–µ—Ö –æ–±—ã—á–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫ —Ç–µ–º, –∫—Ç–æ —Å–ª–∏—à–∫–æ–º –∑–∞–Ω—è—Ç, —á—Ç–æ–±—ã –∏—Å–∫–∞—Ç—å –µ–≥–æ. ‚Äî –ì–µ–Ω—Ä–∏ –î—ç–≤–∏–¥ –¢–æ—Ä–æ.",
    "–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ —É—Å–ø–µ—Ö –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É–µ—Ç —Ä–∞–±–æ—Ç–µ, ‚Äî —ç—Ç–æ —Å–ª–æ–≤–∞—Ä—å. ‚Äî –í–∏–Ω—Å –õ–æ–º–±–∞—Ä–¥–∏.",
    "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ –ª–µ—Å—Ç–Ω–∏—Ü–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –Ω–µ –≤–∑–æ–±—Ä–∞—Ç—å—Å—è, –¥–µ—Ä–∂–∞ —Ä—É–∫–∏ –≤ –∫–∞—Ä–º–∞–Ω–∞—Ö. ‚Äî –ó–∏–≥ –ó–∏–≥–ª–∞—Ä.",
    "–Ø –ø–æ–Ω—è–ª, —á—Ç–æ —É—Å–ø–µ—Ö –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ—Ä—è—Ç—å—Å—è –Ω–µ —Å—Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–≥–æ —á–µ–ª–æ–≤–µ–∫ –¥–æ—Å—Ç–∏–≥ –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏, —Å–∫–æ–ª—å–∫–æ —Ç–µ–º–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ–º—É –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –Ω–∞ –ø—É—Ç–∏ –∫ —É—Å–ø–µ—Ö—É. ‚Äî –ë—É–∫–µ—Ä –¢–∞–ª—å—è—Ñ–µ—Ä—Ä–æ –í–∞—à–∏–Ω–≥—Ç–æ–Ω.",
    "–í –∂–∏–∑–Ω–∏ –Ω–µ—Ç –±–æ–ª—å—à–µ–≥–æ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è, —á–µ–º —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –æ—Ç –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π –Ω–∞ –ø—É—Ç–∏ –∫ —É—Å–ø–µ—Ö—É. ‚Äî –°—ç–º—é—ç–ª –î–∂–æ–Ω—Å–æ–Ω.",
    "–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–µ—É—Å–ø–µ—Ç—å, –º—ã –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º—ã –º–æ–∂–µ–º. ‚Äî –ù–∏–∫–æ—Å –ö–∞–∑–∞–Ω—Ç–∑–∞–∫–∏—Å.",
    "–Ø –Ω–µ –∑–Ω–∞—é –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É, –Ω–æ –∫–ª—é—á –∫ –ø—Ä–æ–≤–∞–ª—É ‚Äî –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è –≤—Å–µ–º. ‚Äî –ë–∏–ª–ª –ö–æ—Å–±–∏.",
    "–ö–æ–≥–¥–∞ –æ–¥–Ω–∞ –¥–≤–µ—Ä—å —Å—á–∞—Å—Ç—å—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥—Ä—É–≥–∞—è; –Ω–æ –º—ã —á–∞—Å—Ç–æ –Ω–µ –∑–∞–º–µ—á–∞–µ–º –µ–µ, —É—Å—Ç–∞–≤–∏–≤—à–∏—Å—å –≤–∑–≥–ª—è–¥–æ–º –≤ –∑–∞–∫—Ä—ã—Ç—É—é –¥–≤–µ—Ä—å. ‚Äî –•–µ–ª–µ–Ω –ê–¥–∞–º—Å –ö–µ–ª–ª–µ—Ä.",
    "–¶–µ–ª–∏ ‚Äî —ç—Ç–æ —Ç–æ–ø–ª–∏–≤–æ –≤ –ø–µ—á–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. ‚Äî –ë—Ä–∞–π–∞–Ω –¢—Ä–µ–π—Å–∏.",
    "–¢–æ, —á—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ, –¥–æ—Å—Ç–∏–≥–∞—è —Å–≤–æ–∏—Ö —Ü–µ–ª–µ–π, –Ω–µ —Ç–∞–∫ –≤–∞–∂–Ω–æ, –∫–∞–∫ —Ç–æ, –∫–µ–º –≤—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å. ‚Äî –ó–∏–≥ –ó–∏–≥–ª–∞—Ä.",
    "–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –¥–µ–ª–∞—Ç—å —Ç–æ, —á–µ–≥–æ –æ—á–µ–Ω—å –Ω–µ —Ö–æ—á–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Ç–æ–≥–æ, —á–µ–≥–æ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è. ‚Äî –î–∂–æ–Ω –ú–∞–∫—Å–≤–µ–ª–ª.",
    "–ë–µ—Ä–µ–≥–∏—Ç–µ —Å–≤–æ–∏ –≤–∏–¥–µ–Ω–∏—è –∏ –º–µ—á—Ç—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ ‚Äî –¥–µ—Ç–∏—â–∞ –≤–∞—à–µ–π –¥—É—à–∏, —á–µ—Ä—Ç–µ–∂–∏ –≤–∞—à–∏—Ö –≤—ã—Å—à–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. ‚Äî –ù–∞–ø–æ–ª–µ–æ–Ω –•–∏–ª–ª.",
    "–ß–µ–º –ª—É—á—à–µ –≤—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, —Ç–µ–º –≤—ã—à–µ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞, –∞ —á–µ–º –≤—ã—à–µ –≤–∞—à–∞ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞, —Ç–µ–º –≤—ã—à–µ –≤–∞—à–∏ —Ü–µ–ª–∏ –∏ —Ç–µ–º –±–æ–ª—å—à–µ–≥–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ—Å—Ç–∏—á—å –≤ –∂–∏–∑–Ω–∏. ‚Äî –ë—Ä–∞–π–∞–Ω –¢—Ä–µ–π—Å–∏.",
    "–û—Å—Ç–∞–≤–∞—Ç—å—Å—è —Å–æ–±–æ–π –≤ –º–∏—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –≤–∞—Å —á–µ–º-–Ω–∏–±—É–¥—å –¥—Ä—É–≥–∏–º, ‚Äî –≤–µ–ª–∏—á–∞–π—à–µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ. ‚Äî –†–∞–ª—å—Ñ –£–æ–ª–¥–æ –≠–º–µ—Ä—Å–æ–Ω.",
    "–°–¥–µ–ª–∞–π —à–∞–≥ ‚Äî –∏ –¥–æ—Ä–æ–≥–∞ –ø–æ—è–≤–∏—Ç—Å—è.",
    "–õ—É—á—à–µ–µ –≤—Ä–µ–º—è –Ω–∞—á–∞—Ç—å ‚Äî —Å–µ–π—á–∞—Å.",
    "–†–∞–∑–±–µ–π –±–æ–ª—å—à—É—é –∑–∞–¥–∞—á—É –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏.",
    "–ú–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å ‚Äî –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å.",
    "–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ, –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–µ —Ö–æ—á–µ—Ç—Å—è.",
    "–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —É—Å–∏–ª–∏–π, –ø–æ–≤—Ç–æ—Ä—è–µ–º—ã—Ö –∏–∑–æ –¥–Ω—è –≤ –¥–µ–Ω—å.",
    "–ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –Ω–∞ –∑–∞–≤—Ç—Ä–∞ —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞ –¥–≤–µ –º–∏–Ω—É—Ç—ã —Å–µ–≥–æ–¥–Ω—è."
]

def random_motivation():
    return random.choice(QUOTES)

def normalize_user_id(user_id):
    if user_id is None:
        return "demo_user"
        
    if isinstance(user_id, int):
        user_id = str(user_id)
    
    if user_id.isdigit() and not user_id.startswith('max_'):
        user_id = f"max_{user_id}"
    
    return user_id

def get_or_create_user(external_id, name=None):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        
        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            user = User(external_id=external_id, name=name)
            db.add(user)
            db.commit()
            db.refresh(user)
        return user
    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def get_user_by_external_id(external_id):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        return user
    except Exception as e:
        print(f"Error getting user: {e}")
        return None
    finally:
        db.close()

def parse_date(date_str):
    try:
        if not date_str:
            return None

        date_str = date_str.strip()

        formats = [
            '%d.%m.%Y', '%d.%m.%y', '%d/%m/%Y', '%d/%m/%y',  
            '%Y-%m-%d',  
            '%m/%d/%Y', '%m/%d/%y'  
        ]

        for fmt in formats:
            try:
                parsed_date = datetime.datetime.strptime(date_str, fmt)
                return parsed_date.replace(hour=12, minute=0, second=0, microsecond=0)
            except ValueError:
                continue

        return None
    except Exception:
        return None

def validate_date(date_str):
    try:
        if not date_str:
            return None, None

        parsed_date = parse_date(date_str)
        if not parsed_date:
            return None, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–π: –¥–¥.–º–º.–≥–≥–≥–≥"

        today = datetime.datetime.utcnow().date()
        parsed_date_only = parsed_date.date()

        if parsed_date_only < today:
            return None, f"‚ùå –î–∞—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–Ω—å—à–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π ({today.strftime('%d.%m.%Y')})"

        return parsed_date, None

    except Exception as e:
        return None, f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–∞—Ç—ã: {str(e)}"

def add_task_for_user(external_id, title, estimated_minutes=0, difficulty=1, task_date=None, parent_id=None, is_parent=False):
    db = SessionLocal()

    try:
        external_id = normalize_user_id(external_id)

        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            user = User(external_id=external_id)
            db.add(user)
            db.commit()
            db.refresh(user)

        if task_date is None:
            task_date = datetime.datetime.utcnow()
        else:
            if isinstance(task_date, str):
                task_date = parse_date(task_date)
                if not task_date:
                    raise ValueError("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã")

        today = datetime.datetime.utcnow().date()
        if task_date.date() < today:
            raise ValueError(f"–î–∞—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–Ω—å—à–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π ({today.strftime('%d.%m.%Y')})")

        task = Task(
            user_id=user.id,
            title=title,
            estimated_minutes=estimated_minutes,
            difficulty=difficulty,
            task_date=task_date,
            parent_id=parent_id,
            is_parent=is_parent
        )

        if estimated_minutes > 0 and estimated_minutes <= 2:
            task.status = 'quick'
        else:
            task.status = 'pending'

        db.add(task)
        db.commit()
        db.refresh(task)

        return task
    except Exception as e:
        db.rollback()
        print(f"Error in add_task_for_user: {e}")
        raise e
    finally:
        db.close()

def add_subtask(external_id, parent_task_id, title, estimated_minutes=0, difficulty=1):
    db = SessionLocal()

    try:
        parent_task = db.query(Task).filter_by(id=parent_task_id).first()
        if not parent_task:
            raise ValueError("–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        
        if parent_task.status == 'done':
            raise ValueError("–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ")
        
        if parent_task.parent_id is not None:
            raise ValueError("–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏ –∫ –¥—Ä—É–≥–æ–π –ø–æ–¥–∑–∞–¥–∞—á–µ")

        print(f"‚úÖ –°–æ–∑–¥–∞–µ–º –ø–æ–¥–∑–∞–¥–∞—á—É –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è {parent_task_id}: '{title}'")

        subtask = add_task_for_user(
            external_id=external_id,
            title=title,
            estimated_minutes=estimated_minutes,
            difficulty=difficulty,
            parent_id=parent_task_id,
            is_parent=False,
            task_date=parent_task.task_date  
        )

        parent_task.is_parent = True
        db.commit()

        print(f"‚úÖ –ü–æ–¥–∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞: {subtask.id}")
        return subtask

    except Exception as e:
        db.rollback()
        print(f"üí• –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏: {e}")
        raise e
    finally:
        db.close()

def list_tasks(external_id, target_date=None):
    db = SessionLocal()

    try:
        external_id = normalize_user_id(external_id)

        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            return []

        query = db.query(Task).filter_by(user_id=user.id)

        if target_date:
            if isinstance(target_date, str):
                target_date = parse_date(target_date)
            if target_date:
                start_of_day = datetime.datetime.combine(target_date.date(), datetime.time.min)
                end_of_day = datetime.datetime.combine(target_date.date(), datetime.time.max)
                query = query.filter(Task.task_date >= start_of_day, Task.task_date <= end_of_day)

        tasks = query.order_by(Task.task_date.desc(), Task.created_at.desc()).all()
        return tasks
    except Exception as e:
        print(f"Error listing tasks: {e}")
        return []
    finally:
        db.close()

def list_tasks_by_date_range(external_id, start_date, end_date):
    db = SessionLocal()

    try:
        external_id = normalize_user_id(external_id)

        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            return []

        start_of_day = datetime.datetime.combine(start_date.date(), datetime.time.min)
        end_of_day = datetime.datetime.combine(end_date.date(), datetime.time.max)

        tasks = db.query(Task).filter_by(user_id=user.id).filter(
            Task.task_date >= start_of_day,
            Task.task_date <= end_of_day
        ).order_by(Task.task_date.desc(), Task.created_at.desc()).all()

        return tasks
    except Exception as e:
        print(f"Error listing tasks by date range: {e}")
        return []
    finally:
        db.close()

def complete_task(external_id, task_id):
    db = SessionLocal()

    try:
        external_id = normalize_user_id(external_id)

        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            return None

        task = db.query(Task).filter_by(id=task_id, user_id=user.id).first()
        if not task:
            return None

        task.status = 'done'
        db.commit()

        completed_task_data = {
            'id': task.id,
            'title': task.title,
            'status': task.status,
            'is_parent': task.is_parent,
            'parent_id': task.parent_id
        }

        return completed_task_data

    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def complete_subtask(external_id, parent_task_id, subtask_id):
    db = SessionLocal()

    try:
        external_id = normalize_user_id(external_id)

        user = db.query(User).filter_by(external_id=external_id).first()
        if not user:
            return None

        subtask = db.query(Task).filter_by(
            id=subtask_id, 
            user_id=user.id,
            parent_id=parent_task_id
        ).first()
        
        if not subtask:
            return None

        subtask.status = 'done'
        db.commit()

        return {
            'id': subtask.id,
            'title': subtask.title,
            'status': subtask.status
        }

    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def complete_parent_task(parent_task_id):
    db = SessionLocal()
    try:
        parent = db.query(Task).filter_by(id=parent_task_id).first()
        if not parent:
            return None

        parent.status = 'done'

        subtasks = db.query(Task).filter_by(parent_id=parent_task_id).all()
        for subtask in subtasks:
            subtask.status = 'done'

        db.commit()

        return {
            'id': parent.id,
            'title': parent.title,
            'subtasks_completed': len(subtasks)
        }
    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def get_subtasks(parent_task_id):
    db = SessionLocal()
    try:
        subtasks = db.query(Task).filter_by(parent_id=parent_task_id).order_by(Task.id).all()
        return subtasks
    except Exception as e:
        print(f"üí• –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á: {e}")
        return []
    finally:
        db.close()

def get_task_progress(parent_task_id):
    db = SessionLocal()
    try:
        parent_task = db.query(Task).filter_by(id=parent_task_id).first()
        if not parent_task:
            return (0, 0, 0)
        
        if parent_task.status == 'done':
            subtasks = db.query(Task).filter_by(parent_id=parent_task_id).all()
            total = len(subtasks) if subtasks else 1
            return (total, total, 100)
        
        subtasks = db.query(Task).filter_by(parent_id=parent_task_id).all()
        if not subtasks:
            return (0, 0, 0)

        completed = len([t for t in subtasks if t.status == 'done'])
        total = len(subtasks)
        progress = int((completed / total) * 100) if total > 0 else 0

        return (completed, total, progress)
    except Exception as e:
        print(f"üí• –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: {e}")
        return (0, 0, 0)
    finally:
        db.close()

def get_task_by_id(task_id):
    db = SessionLocal()
    try:
        task = db.query(Task).filter_by(id=task_id).first()
        return task
    except Exception as e:
        print(f"Error getting task: {e}")
        return None
    finally:
        db.close()

def list_subtasks(parent_task_id):
    db = SessionLocal()
    try:
        subtasks = db.query(Task).filter_by(parent_id=parent_task_id).order_by(Task.id).all()
        return subtasks
    except Exception as e:
        print(f"üí• –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á: {e}")
        return []
    finally:
        db.close()


def ai_enhanced_daily_analysis(user, tasks, for_react=False):
    today = datetime.datetime.utcnow().date()
    today_tasks = [t for t in tasks if t.created_at.date() == today]

    if not today_tasks:
        base_result = {
            'result': 'neutral',
            'text': "üìù –°–µ–≥–æ–¥–Ω—è –µ—â–µ –Ω–µ—Ç –∑–∞–¥–∞—á. –ù–∞—á–Ω–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —à–∞–≥–∞!",
            'emoji': "ü§î",
            'stats': {'done': 0, 'pending': 0, 'total': 0, 'completion_rate': 0}
        }
        if for_react:
            base_result['recommendation'] = "–ü–æ–ø—Ä–æ–±—É–π –¥–æ–±–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –∑–∞–¥–∞—á—É –Ω–∞ 2 –º–∏–Ω—É—Ç—ã."
        return base_result

    completed_today = [t for t in today_tasks if t.status == 'done']
    pending_today = [t for t in today_tasks if t.status != 'done']
    completion_rate = len(completed_today) / len(today_tasks) if today_tasks else 0

    total_minutes = sum(t.estimated_minutes for t in today_tasks)
    completed_minutes = sum(t.estimated_minutes for t in completed_today)
    time_utilization = (completed_minutes / total_minutes * 100) if total_minutes > 0 else 0

    try:
        ai_analysis = get_ai_daily_insights({
            'completed_tasks': [t.title for t in completed_today],
            'pending_tasks': [t.title for t in pending_today],
            'completion_rate': completion_rate,
            'total_tasks': len(today_tasks),
            'user_level': user.level,
            'total_minutes': total_minutes,
            'completed_minutes': completed_minutes,
            'time_utilization': time_utilization
        })

        if ai_analysis:
            if for_react:
                return format_ai_analysis_for_react(ai_analysis, completed_today, pending_today, today_tasks, total_minutes, completed_minutes, time_utilization)
            else:
                return format_ai_analysis_for_bot(ai_analysis, completed_today, pending_today, today_tasks)

    except Exception as e:
        logging.info(f"AI analysis failed, using fallback: {e}")

    if for_react:
        return generate_fallback_analysis_react(completed_today, pending_today, today_tasks, total_minutes, completed_minutes, time_utilization)
    else:
        return generate_fallback_analysis_bot(completed_today, pending_today, today_tasks)

def format_ai_analysis_for_react(ai_analysis, completed, pending, today_tasks, total_minutes, completed_minutes, time_utilization):
    completion_rate = len(completed) / len(today_tasks) if today_tasks else 0
    
    mood_mapping = {
        'excellent': 'positive',
        'good': 'positive',
        'moderate': 'neutral', 
        'needs_improvement': 'needs_improvement',
        'motivation': 'neutral',
        'fail': 'needs_improvement'
    }
    
    energy_mapping = {
        'excellent': 'high',
        'good': 'high',
        'moderate': 'medium',
        'needs_improvement': 'low',
        'motivation': 'medium',
        'fail': 'low'
    }

    return {
        'result': ai_analysis.get('mood', 'neutral'),
        'text': f"{ai_analysis.get('emoji', 'üìä')} {ai_analysis.get('analysis', '–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...')}",
        'recommendation': ai_analysis.get('recommendation', '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!'),
        'emoji': ai_analysis.get('emoji', 'üìä'),
        'stats': {
            'done': len(completed),
            'pending': len(pending),
            'total': len(today_tasks),
            'completion_rate': int(completion_rate * 100)
        },
        'time_stats': {
            'total_minutes': total_minutes,
            'completed_minutes': completed_minutes,
            'time_utilization': int(time_utilization)
        },
        'react_format': {
            'productivity_score': int(completion_rate * 100),
            'energy_level': energy_mapping.get(ai_analysis.get('mood', 'neutral'), 'medium'),
            'mood_analysis': mood_mapping.get(ai_analysis.get('mood', 'neutral'), 'neutral'),
            'insights': [ai_analysis.get('analysis', '–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏')],
            'recommendations': [ai_analysis.get('recommendation', '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –∑–∞–¥–∞—á–∞–º–∏')]
        }
    }

def generate_fallback_analysis_bot(completed, pending, today_tasks):
    completion_rate = len(completed) / len(today_tasks) if today_tasks else 0

    if completion_rate >= 0.8:
        emoji = "üéâ"
        mood = "excellent"
        analysis = f"–û—Ç–ª–∏—á–Ω–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!"
        recommendation = "–¢—ã —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –≤—ã—Å–æ—Ç–µ! –ú–æ–∂–µ—à—å –≤–∑—è—Ç—å—Å—è –∑–∞ —á—Ç–æ-—Ç–æ —Å–ª–æ–∂–Ω–æ–µ!"
    elif completion_rate >= 0.6:
        emoji = "üöÄ"
        mood = "good"
        analysis = f"–•–æ—Ä–æ—à–∏–π —Ç–µ–º–ø! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á —Å–¥–µ–ª–∞–Ω–æ!"
        recommendation = "–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ! –ó–∞–≤—Ç—Ä–∞ –¥–æ–±—å–µ—à—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è!"
    elif completion_rate >= 0.3:
        emoji = "üí™"
        mood = "moderate"
        analysis = f"–ù–µ–ø–ª–æ—Ö–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –∑–∞–≤–µ—Ä—à–µ–Ω–æ."
        recommendation = "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞—á–∞—Ç—ã—Ö –∑–∞–¥–∞—á!"
    elif len(completed) > 0:
        emoji = "üìà"
        mood = "needs_improvement"
        analysis = f"–ï—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ."
        recommendation = "–ù–∞—á–Ω–∏ –∑–∞–≤—Ç—Ä–∞ —Å —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏!"
    else:
        emoji = "üéØ"
        mood = "motivation"
        analysis = "–°–µ–≥–æ–¥–Ω—è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª, –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å!"
        recommendation = "–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É –∏ –Ω–∞—á–Ω–∏ —Å–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å!"

    text = f"{emoji} **–ê–Ω–∞–ª–∏–∑ –¥–Ω—è:**\n\n"
    text += f"üìä *{analysis}*\n\n"
    text += f"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {len(completed)} –∏–∑ {len(today_tasks)}\n"
    text += f"‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: {len(pending)}\n\n"
    text += f"üí° *{recommendation}*"

    return {
        'result': mood,
        'text': text,
        'emoji': emoji,
        'stats': {
            'done': len(completed),
            'pending': len(pending),
            'total': len(today_tasks),
            'completion_rate': int(completion_rate * 100)
        }
    }

def generate_fallback_analysis_react(completed, pending, today_tasks, total_minutes, completed_minutes, time_utilization):
    completion_rate = len(completed) / len(today_tasks) if today_tasks else 0

    if completion_rate >= 0.8:
        emoji = "üéâ"
        mood = "excellent"
        analysis = f"–û—Ç–ª–∏—á–Ω–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!"
        recommendation = "–¢—ã —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –≤—ã—Å–æ—Ç–µ! –ú–æ–∂–µ—à—å –≤–∑—è—Ç—å—Å—è –∑–∞ —á—Ç–æ-—Ç–æ —Å–ª–æ–∂–Ω–æ–µ!"
    elif completion_rate >= 0.6:
        emoji = "üöÄ"
        mood = "good"
        analysis = f"–•–æ—Ä–æ—à–∏–π —Ç–µ–º–ø! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á —Å–¥–µ–ª–∞–Ω–æ!"
        recommendation = "–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ! –ó–∞–≤—Ç—Ä–∞ –¥–æ–±—å–µ—à—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è!"
    elif completion_rate >= 0.3:
        emoji = "üí™"
        mood = "moderate"
        analysis = f"–ù–µ–ø–ª–æ—Ö–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –∑–∞–≤–µ—Ä—à–µ–Ω–æ."
        recommendation = "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞—á–∞—Ç—ã—Ö –∑–∞–¥–∞—á!"
    elif len(completed) > 0:
        emoji = "üìà"
        mood = "needs_improvement"
        analysis = f"–ï—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ."
        recommendation = "–ù–∞—á–Ω–∏ –∑–∞–≤—Ç—Ä–∞ —Å —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏!"
    else:
        emoji = "üéØ"
        mood = "motivation"
        analysis = "–°–µ–≥–æ–¥–Ω—è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª, –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å!"
        recommendation = "–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É –∏ –Ω–∞—á–Ω–∏ —Å–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å!"

    return {
        'result': mood,
        'text': f"{emoji} {analysis}",
        'recommendation': recommendation,
        'emoji': emoji,
        'stats': {
            'done': len(completed),
            'pending': len(pending),
            'total': len(today_tasks),
            'completion_rate': int(completion_rate * 100)
        },
        'time_stats': {
            'total_minutes': total_minutes,
            'completed_minutes': completed_minutes,
            'time_utilization': int(time_utilization)
        },
        'react_format': {
            'productivity_score': int(completion_rate * 100),
            'energy_level': 'high' if completion_rate >= 0.7 else 'medium',
            'mood_analysis': 'positive' if completion_rate >= 0.7 else 'neutral',
            'insights': [analysis],
            'recommendations': [recommendation]
        }
    }

def get_ai_daily_insights(daily_data):
    try:
        from gigachat_client import gigachat_client

        prompt = f"""
        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è –∏ –¥–∞–π –∫—Ä–∞—Ç–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã –¥–ª—è –±–æ—Ç–∞.

        –î–ê–ù–ù–´–ï:
        - –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á: {len(daily_data['completed_tasks'])}
        - –ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á: {len(daily_data['pending_tasks'])}  
        - –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {daily_data['completion_rate']:.0%}
        - –í—Å–µ–≥–æ –∑–∞–¥–∞—á —Å–µ–≥–æ–¥–Ω—è: {daily_data['total_tasks']}
        - –£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {daily_data['user_level']}

        –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò: {', '.join(daily_data['completed_tasks'][:5])}
        –ù–ï–í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò: {', '.join(daily_data['pending_tasks'][:5])}

        –î–∞–π –∫—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
        –≠–ú–û–î–ó–ò|–û–¶–ï–ù–ö–ê|–ö–†–ê–¢–ö–ò–ô_–ê–ù–ê–õ–ò–ó|–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

        –ü—Ä–∏–º–µ—Ä—ã:
        üéâ|excellent|–û—Ç–ª–∏—á–Ω–æ! 5 –∏–∑ 5 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ|–¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å! –¢—ã –Ω–∞ –≤—ã—Å–æ—Ç–µ!
        üí™|good|–•–æ—Ä–æ—à–∏–π —Ç–µ–º–ø, 4 –∏–∑ 5 –∑–∞–¥–∞—á —Å–¥–µ–ª–∞–Ω–æ|–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ! –ó–∞–≤—Ç—Ä–∞ –¥–æ–±—å–µ—à—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è!
        üìà|moderate|–ù–µ–ø–ª–æ—Ö–æ, –Ω–æ –µ—Å—Ç—å –Ω–∞–¥ —á–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å|–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞—á–∞—Ç–æ–≥–æ!
        üöÄ|motivation|–°–µ–≥–æ–¥–Ω—è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª, –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å!|–ù–∞—á–Ω–∏ —Å —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏!

        –¢–≤–æ–π –∞–Ω–∞–ª–∏–∑:
        """

        response = gigachat_client._make_gigachat_request(prompt)
        if response:
            parts = response.split('|')
            if len(parts) == 4:
                return {
                    'emoji': parts[0].strip(),
                    'mood': parts[1].strip(),
                    'analysis': parts[2].strip(),
                    'recommendation': parts[3].strip()
                }

    except Exception as e:
        logging.info(f"GigaChat insights failed: {e}")

    return None


def format_ai_analysis_for_bot(ai_analysis, completed, pending, today_tasks):
    completion_rate = len(completed) / len(today_tasks) if today_tasks else 0

    text = f"{ai_analysis['emoji']} **AI –ê–Ω–∞–ª–∏–∑ –¥–Ω—è:**\n\n"
    text += f"üìä *{ai_analysis['analysis']}*\n\n"
    text += f"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {len(completed)} –∏–∑ {len(today_tasks)}\n"
    text += f"‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: {len(pending)}\n\n"
    text += f"üí° *{ai_analysis['recommendation']}*"

    return {
        'result': ai_analysis['mood'],
        'text': text,
        'emoji': ai_analysis['emoji'],
        'stats': {
            'done': len(completed),
            'pending': len(pending),
            'total': len(today_tasks),
            'completion_rate': int(completion_rate * 100)
        }
    }


def generate_fallback_analysis(completed, pending, today_tasks):
    completion_rate = len(completed) / len(today_tasks) if today_tasks else 0

    if completion_rate >= 0.8:
        emoji = "üéâ"
        mood = "excellent"
        analysis = f"–û—Ç–ª–∏—á–Ω–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!"
        recommendation = "–¢—ã —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –≤—ã—Å–æ—Ç–µ! –ú–æ–∂–µ—à—å –≤–∑—è—Ç—å—Å—è –∑–∞ —á—Ç–æ-—Ç–æ —Å–ª–æ–∂–Ω–æ–µ!"
    elif completion_rate >= 0.6:
        emoji = "üöÄ"
        mood = "good"
        analysis = f"–•–æ—Ä–æ—à–∏–π —Ç–µ–º–ø! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á —Å–¥–µ–ª–∞–Ω–æ!"
        recommendation = "–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ! –ó–∞–≤—Ç—Ä–∞ –¥–æ–±—å–µ—à—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è!"
    elif completion_rate >= 0.3:
        emoji = "üí™"
        mood = "moderate"
        analysis = f"–ù–µ–ø–ª–æ—Ö–æ! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –∑–∞–≤–µ—Ä—à–µ–Ω–æ."
        recommendation = "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞—á–∞—Ç—ã—Ö –∑–∞–¥–∞—á!"
    elif len(completed) > 0:
        emoji = "üìà"
        mood = "needs_improvement"
        analysis = f"–ï—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å! {len(completed)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ."
        recommendation = "–ù–∞—á–Ω–∏ –∑–∞–≤—Ç—Ä–∞ —Å —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏!"
    else:
        emoji = "üéØ"
        mood = "motivation"
        analysis = "–°–µ–≥–æ–¥–Ω—è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª, –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å!"
        recommendation = "–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É –∏ –Ω–∞—á–Ω–∏ —Å–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å!"

    text = f"{emoji} **–ê–Ω–∞–ª–∏–∑ –¥–Ω—è:**\n\n"
    text += f"üìä *{analysis}*\n\n"
    text += f"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {len(completed)} –∏–∑ {len(today_tasks)}\n"
    text += f"‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: {len(pending)}\n\n"
    text += f"üí° *{recommendation}*"

    return {
        'result': mood,
        'text': text,
        'emoji': emoji,
        'stats': {
            'done': len(completed),
            'pending': len(pending),
            'total': len(today_tasks),
            'completion_rate': int(completion_rate * 100)
        }
    }


def analyze_day(user, tasks):
    today = datetime.datetime.utcnow().date()
    done = [t for t in tasks if t.status == 'done' and t.created_at.date() == today]
    pending = [t for t in tasks if t.status != 'done' and t.created_at.date() == today]
    score = len(done) - len(pending)

    if score >= 3:
        result = 'success'
        text = f"üéâ –û—Ç–ª–∏—á–Ω–æ! –°–µ–≥–æ–¥–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω–æ {len(done)} –∑–∞–¥–∞—á. –¢—ã –ø—Ä–æ—Å—Ç–æ –º–∞—à–∏–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!"
    elif score >= 1:
        result = 'success'
        text = f"‚úÖ –•–æ—Ä–æ—à–æ! –í—ã–ø–æ–ª–Ω–µ–Ω–æ {len(done)} –∑–∞–¥–∞—á. –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!"
    elif score == 0:
        result = 'neutral'
        text = f"‚öñÔ∏è –ù–æ—Ä–º. –í—ã–ø–æ–ª–Ω–∏–ª {len(done)} –∑–∞–¥–∞—á –∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª {len(pending)}. –ó–∞–≤—Ç—Ä–∞ –±—É–¥–µ—Ç –ª—É—á—à–µ!"
    else:
        result = 'fail'
        text = f"üíÄ –•–º–º... –í—ã–ø–æ–ª–Ω–µ–Ω–æ {len(done)} –∑–∞–¥–∞—á, –Ω–æ {len(pending)} –Ω–µ —Å–¥–µ–ª–∞–Ω–æ. –ù–µ –±—É–¥—å –Ω—É–±–æ–º ‚Äî –Ω–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ!"

    return {'result': result, 'text': text, 'stats': {'done': len(done), 'pending': len(pending), 'score': score}}

def update_user_profile(external_id, name=None, energy=None, level=None):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        
        if user:
            if name is not None:
                user.name = name
            if energy is not None:
                user.energy = energy
            if level is not None:
                user.level = level
                
            db.commit()
            db.refresh(user)
            
        return user
    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def sync_user_from_max(external_id, max_user_data):
    if not max_user_data:
        return None
        
    name = f"{max_user_data.get('first_name', '')} {max_user_data.get('last_name', '')}".strip()
    if not name:
        name = max_user_data.get('username', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å MAX')
    
    return update_user_profile(external_id, name=name)

def get_user_stats(external_id):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        
        if not user:
            return None
            
        tasks = db.query(Task).filter_by(user_id=user.id).all()
        total_tasks = len(tasks)
        completed_tasks = len([t for t in tasks if t.status == 'done'])
        pending_tasks = len([t for t in tasks if t.status != 'done'])
        
        completion_rate = round((completed_tasks / total_tasks * 100) if total_tasks > 0 else 0, 1)
        
        difficulty_stats = {
            'high': len([t for t in tasks if t.difficulty >= 4]),
            'medium': len([t for t in tasks if t.difficulty == 3]),
            'low': len([t for t in tasks if t.difficulty <= 2]),
        }
        
        return {
            'user_id': user.external_id,
            'name': user.name,
            'energy': user.energy,
            'level': user.level,
            'total_tasks': total_tasks,
            'completed_tasks': completed_tasks,
            'pending_tasks': pending_tasks,
            'completion_rate': completion_rate,
            'difficulty_stats': difficulty_stats
        }
    except Exception as e:
        print(f"Error getting user stats: {e}")
        return None
    finally:
        db.close()

def delete_task(external_id, task_id):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        
        if not user:
            return False
            
        task = db.query(Task).filter_by(id=task_id, user_id=user.id).first()
        if not task:
            return False
            
        db.delete(task)
        db.commit()
        return True
    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def update_task(external_id, task_id, title=None, description=None, estimated_minutes=None, 
               difficulty=None, status=None, task_date=None):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        
        if not user:
            return None
            
        task = db.query(Task).filter_by(id=task_id, user_id=user.id).first()
        if not task:
            return None
            
        if title is not None:
            task.title = title
        if description is not None:
            task.description = description
        if estimated_minutes is not None:
            task.estimated_minutes = estimated_minutes
        if difficulty is not None:
            task.difficulty = difficulty
        if status is not None:
            task.status = status
        if task_date is not None:
            if hasattr(task_date, 'date'):
                today = datetime.datetime.utcnow().date()
                task_date_only = task_date.date()
                if task_date_only < today:
                    raise ValueError(f"–î–∞—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–Ω—å—à–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π ({today.strftime('%d.%m.%Y')})")
            task.task_date = task_date
            
        db.commit()
        db.refresh(task)
        return task
    except Exception as e:
        db.rollback()
        raise e
    finally:
        db.close()

def get_today_stats(external_id):
    db = SessionLocal()
    
    try:
        external_id = normalize_user_id(external_id)
        user = db.query(User).filter_by(external_id=external_id).first()
        
        if not user:
            return None
            
        today = datetime.datetime.utcnow().date()
        tasks = db.query(Task).filter_by(user_id=user.id).filter(
            Task.created_at >= today
        ).all()
        
        completed_today = len([t for t in tasks if t.status == 'done'])
        pending_today = len([t for t in tasks if t.status != 'done'])
        
        return {
            'completed_today': completed_today,
            'pending_today': pending_today,
            'total_today': len(tasks)
        }
    except Exception as e:
        print(f"Error getting today stats: {e}")
        return None
    finally:
        db.close()

def get_user_by_max_id(max_user_id):
    db = SessionLocal()
    try:
        external_id = f"max_{max_user_id}"
        user = db.query(User).filter_by(external_id=external_id).first()
        return user
    finally:
        db.close()

def sync_tasks_between_users(source_user_id, target_user_id):
    db = SessionLocal()
    try:
        source_user = db.query(User).filter_by(external_id=source_user_id).first()
        target_user = db.query(User).filter_by(external_id=target_user_id).first()
        
        if not source_user or not target_user:
            return False
            
        source_tasks = db.query(Task).filter_by(user_id=source_user.id).all()
        
        for task in source_tasks:
            existing_task = db.query(Task).filter_by(
                user_id=target_user.id, 
                title=task.title,
                status=task.status
            ).first()
            
            if not existing_task:
                new_task = Task(
                    user_id=target_user.id,
                    title=task.title,
                    description=task.description,
                    difficulty=task.difficulty,
                    status=task.status,
                    estimated_minutes=task.estimated_minutes,
                    task_date=task.task_date
                )
                db.add(new_task)
        
        db.commit()
        return True
    except Exception as e:
        db.rollback()
        print(f"Sync error: {e}")
        return False
    finally:
        db.close()

def enhanced_daily_analysis(user, tasks):
    today = datetime.datetime.utcnow().date()
    today_tasks = [t for t in tasks if t.created_at.date() == today]
    
    if not today_tasks:
        return {
            'result': 'neutral',
            'text': "üìù –°–µ–≥–æ–¥–Ω—è –µ—â–µ –Ω–µ—Ç –∑–∞–¥–∞—á. –ù–∞—á–Ω–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —à–∞–≥–∞!",
            'recommendation': "–ü–æ–ø—Ä–æ–±—É–π –¥–æ–±–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –∑–∞–¥–∞—á—É –Ω–∞ 2 –º–∏–Ω—É—Ç—ã.",
            'emoji': "ü§î"
        }
    
    completed_today = [t for t in today_tasks if t.status == 'done']
    pending_today = [t for t in today_tasks if t.status != 'done']
    
    completion_ratio = len(completed_today) / len(today_tasks) if today_tasks else 0
    
    avg_difficulty = sum(t.difficulty for t in today_tasks) / len(today_tasks)
    completed_difficulty = sum(t.difficulty for t in completed_today) / len(completed_today) if completed_today else 0
    
    if completion_ratio >= 0.8:
        result = 'success'
        emoji = "üéâ"
        text = f"–û—Ç–ª–∏—á–Ω–æ! –í—ã–ø–æ–ª–Ω–µ–Ω–æ {len(completed_today)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á!"
        recommendation = "–¢—ã —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –≤—ã—Å–æ—Ç–µ! –ú–æ–∂–µ—à—å –≤–∑—è—Ç—å—Å—è –∑–∞ —á—Ç–æ-—Ç–æ —Å–ª–æ–∂–Ω–æ–µ."
    elif completion_ratio >= 0.5:
        result = 'success'
        emoji = "üëç"
        text = f"–•–æ—Ä–æ—à–æ! –í—ã–ø–æ–ª–Ω–µ–Ω–æ {len(completed_today)} –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á."
        recommendation = "–ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! –¢—ã –±–ª–∏–∑–æ–∫ –∫ –æ—Ç–ª–∏—á–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É."
    elif completion_ratio > 0:
        result = 'neutral'
        emoji = "üí™"
        text = f"–ù–µ–ø–ª–æ—Ö–æ, –Ω–æ –º–æ–∂–Ω–æ –ª—É—á—à–µ. –í—ã–ø–æ–ª–Ω–µ–Ω–æ {len(completed_today)} –∏–∑ {len(today_tasks)}."
        recommendation = "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ –∑–∞ —Ä–∞–∑. –ò—Å–ø–æ–ª—å–∑—É–π Pomodoro —Ç–∞–π–º–µ—Ä!"
    else:
        result = 'fail'
        emoji = "üíÄ"
        text = f"–≠–π, –Ω—É–±–∏–∫! 0 –∏–∑ {len(today_tasks)} –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –°–æ–±–µ—Ä–∏—Å—å!"
        recommendation = "–ù–∞—á–Ω–∏ —Å —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏. –î–∞–∂–µ 2 –º–∏–Ω—É—Ç—ã —Ä–∞–±–æ—Ç—ã - —ç—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å!"
    
    if avg_difficulty > 3 and completion_ratio < 0.5:
        recommendation += " –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏? –†–∞–∑–±–µ–π –∏—Ö –Ω–∞ —á–∞—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–æ–π /decompose"
    
    return {
        'result': result,
        'text': text,
        'recommendation': recommendation,
        'emoji': emoji,
        'stats': {
            'completed': len(completed_today),
            'pending': len(pending_today),
            'total': len(today_tasks),
            'completion_ratio': round(completion_ratio * 100),
            'avg_difficulty': round(avg_difficulty, 1)
        }
    }

def ensure_user_sync(max_user_id, username):
    db = SessionLocal()
    try:
        max_external_id = f"max_{max_user_id}"
        web_external_id = f"user_{username.lower().replace(' ', '_')}"
        
        max_user = db.query(User).filter_by(external_id=max_external_id).first()
        web_user = db.query(User).filter_by(external_id=web_external_id).first()
        
        if max_user and web_user and max_user.id != web_user.id:
            sync_tasks_between_users(max_external_id, web_external_id)
            sync_tasks_between_users(web_external_id, max_external_id)
            
        return web_external_id
    finally:
        db.close()

try:
    from gigachat_client import gigachat_client
    
    def decompose_task(title: str, user_id: str = None) -> List[str]:
        print(f"üîç decompose_task –≤—ã–∑–≤–∞–Ω–∞ —Å: '{title}' –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_id}")

        try:
            parent_task = add_task_for_user(
                external_id=user_id,
                title=title,
                is_parent=True 
            )
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: {parent_task.id} - '{title}'")

            ai_steps = gigachat_client.decompose_task(title)

            if ai_steps:
                print(f"‚úÖ GigaChat –≤–µ—Ä–Ω—É–ª —à–∞–≥–∏: {ai_steps}")

                created_subtasks = []
                for step in ai_steps:
                    subtask = add_subtask(
                        external_id=user_id,
                        parent_task_id=parent_task.id,
                        title=step
                    )
                    created_subtasks.append(subtask)
                    print(f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∞: {subtask.id} - '{step}'")

                print(f"‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–æ {len(created_subtasks)} –ø–æ–¥–∑–∞–¥–∞—á")
                return ai_steps

            else:
                print("‚ùå GigaChat –Ω–µ –≤–µ—Ä–Ω—É–ª —à–∞–≥–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback")
                fallback_steps = decompose_task_fallback(title)
                if user_id and fallback_steps:
                    for step in fallback_steps:
                        add_subtask(user_id, parent_task.id, step)
                return fallback_steps

        except Exception as e:
            print(f"üí• –û—à–∏–±–∫–∞ –≤ decompose_task: {e}")
            logging.error(f"Decomposition failed: {e}")
            return decompose_task_fallback(title)

    def decompose_task_fallback(title: str) -> List[str]:
        hints = []
        parts = [p.strip() for p in (title.replace(' –∏ ', ',').split(',')) if p.strip()]

        if len(parts) <= 1:
            words = title.split()
            if len(words) <= 3:
                hints = [
                    f"1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è '{title}'",
                    f"2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è",
                    f"3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å"
                ]
            else:
                for i, word in enumerate(words[:4], 1):
                    hints.append(f"{i}. –î–µ–π—Å—Ç–≤–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å '{word}'")
        else:
            for i, p in enumerate(parts[:4], 1):
                hints.append(f"{i}. {p}")

        return hints

except ImportError:
    print("‚ö†Ô∏è GigaChat client not available")
    
    def decompose_task(title: str, user_id: str = None) -> List[str]:
        fallback_steps = decompose_task_fallback(title)
        
        if user_id:
            parent_task = add_task_for_user(
                external_id=user_id,
                title=title,
                is_parent=True
            )
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞: {parent_task.id} - '{title}'")
            
            for step in fallback_steps:
                add_subtask(user_id, parent_task.id, step)
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ {len(fallback_steps)} –ø–æ–¥–∑–∞–¥–∞—á –∏–∑ fallback")
        
        return fallback_steps
    
    def decompose_task_fallback(title: str) -> List[str]:
        hints = []
        parts = [p.strip() for p in (title.replace(' –∏ ', ',').split(',')) if p.strip()]

        if len(parts) <= 1:
            words = title.split()
            if len(words) <= 3:
                hints = [
                    f"1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è '{title}'",
                    f"2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è",
                    f"3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å"
                ]
            else:
                for i, word in enumerate(words[:4], 1):
                    hints.append(f"{i}. –î–µ–π—Å—Ç–≤–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å '{word}'")
        else:
            for i, p in enumerate(parts[:4], 1):
                hints.append(f"{i}. {p}")

        return hints

def create_project(external_id, title, description=None, color="#3b82f6"):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return None
        
        project = Project(
            user_id=user.id,
            title=title,
            description=description,
            color=color
        )
        db.add(project)
        db.commit()
        db.refresh(project)
        
        default_columns = [
            {"title": "üìã –ë—ç–∫–ª–æ–≥", "color": "#6b7280", "position": 0},
            {"title": "üîÑ –í —Ä–∞–±–æ—Ç–µ", "color": "#f59e0b", "position": 1},
            {"title": "‚úÖ –ì–æ—Ç–æ–≤–æ", "color": "#10b981", "position": 2}
        ]
        
        for col_data in default_columns:
            column = BoardColumn(
                project_id=project.id,
                title=col_data["title"],
                color=col_data["color"],
                position=col_data["position"]
            )
            db.add(column)
        
        db.commit()
        return project
        
    except Exception as e:
        db.rollback()
        print(f"Error creating project: {e}")
        return None
    finally:
        db.close()

def get_user_projects(external_id):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return []
        
        projects = db.query(Project).filter_by(user_id=user.id).order_by(Project.created_at.desc()).all()
        return projects
    except Exception as e:
        print(f"Error getting user projects: {e}")
        return []
    finally:
        db.close()

def create_card(column_id, external_id, title, description=None, color="#ffffff", tags=None, 
                due_date=None, estimated_minutes=0, priority=1):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return None
        
        column = db.query(BoardColumn).join(Project).filter(
            BoardColumn.id == column_id,
            Project.user_id == user.id
        ).first()
        if not column:
            return None
        
        max_position_result = db.query(func.max(BoardCard.position)).filter_by(column_id=column_id).first()
        max_position = max_position_result[0] if max_position_result[0] is not None else 0
        
        tags_str = None
        if tags:
            tags_str = ','.join(tags)
        
        card = BoardCard(
            column_id=column_id,
            title=title,
            description=description,
            color=color,
            tags=tags_str,
            due_date=due_date,
            estimated_minutes=estimated_minutes,
            priority=priority,
            position=max_position + 1
        )
        db.add(card)
        db.commit()
        db.refresh(card)
        
        return card
        
    except Exception as e:
        db.rollback()
        print(f"Error creating card: {e}")
        return None
    finally:
        db.close()

def get_project_with_details(project_id, external_id):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return None
        
        project = db.query(Project).filter_by(id=project_id, user_id=user.id).first()
        if not project:
            return None
        
        columns = db.query(BoardColumn).filter_by(project_id=project_id).order_by(BoardColumn.position).all()
        
        result_columns = []
        for column in columns:
            cards = db.query(BoardCard).filter_by(column_id=column.id).order_by(BoardCard.position).all()
            
            column_data = {
                "id": column.id,
                "title": column.title,
                "color": column.color,
                "position": column.position,
                "cards": []
            }
            
            for card in cards:
                card_data = {
                    "id": card.id,
                    "title": card.title,
                    "description": card.description,
                    "color": card.color,
                    "tags": card.tags.split(',') if card.tags else [],
                    "due_date": card.due_date,
                    "estimated_minutes": card.estimated_minutes,
                    "priority": card.priority,
                    "position": card.position,
                    "created_at": card.created_at,
                    "updated_at": card.updated_at
                }
                column_data["cards"].append(card_data)
            
            result_columns.append(column_data)
        
        project_data = {
            "id": project.id,
            "title": project.title,
            "description": project.description,
            "color": project.color,
            "created_at": project.created_at,
            "updated_at": project.updated_at,
            "columns": result_columns
        }
        
        return project_data
        
    except Exception as e:
        print(f"Error getting project details: {e}")
        return None
    finally:
        db.close()

def update_card_position(card_id, external_id, new_column_id=None, new_position=None):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return False
        
        card = db.query(BoardCard).join(BoardColumn).join(Project).filter(
            BoardCard.id == card_id,
            Project.user_id == user.id
        ).first()
        if not card:
            return False
        
        if new_column_id is not None:
            new_column = db.query(BoardColumn).join(Project).filter(
                BoardColumn.id == new_column_id,
                Project.user_id == user.id
            ).first()
            if not new_column:
                return False
            card.column_id = new_column_id
        
        if new_position is not None:
            card.position = new_position
        
        card.updated_at = datetime.datetime.utcnow()
        db.commit()
        return True
        
    except Exception as e:
        db.rollback()
        print(f"Error updating card position: {e}")
        return False
    finally:
        db.close()

def delete_card(card_id, external_id):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return False
        
        card = db.query(BoardCard).join(BoardColumn).join(Project).filter(
            BoardCard.id == card_id,
            Project.user_id == user.id
        ).first()
        if not card:
            return False
        
        db.delete(card)
        db.commit()
        return True
        
    except Exception as e:
        db.rollback()
        print(f"Error deleting card: {e}")
        return False
    finally:
        db.close()

def delete_project(project_id, external_id):
    db = SessionLocal()
    try:
        user = get_user_by_external_id(external_id)
        if not user:
            return False
        
        project = db.query(Project).filter_by(id=project_id, user_id=user.id).first()
        if not project:
            return False
        
        db.delete(project)
        db.commit()
        return True
        
    except Exception as e:
        db.rollback()
        print(f"Error deleting project: {e}")
        return False
    finally:
        db.close()